  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (370.5ms)[0m   [0mCREATE TABLE `affiliate_payments` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `created_at` datetime, `affiliate_id` int(11) DEFAULT 0 NOT NULL, `amount` float DEFAULT 0.0 NOT NULL, `notes` text) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (138.1ms)[0m   [0mCREATE TABLE `affiliates` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `code` varchar(15) DEFAULT '' NOT NULL, `first_name` varchar(50) DEFAULT '' NOT NULL, `last_name` varchar(50) DEFAULT '' NOT NULL, `telephone` varchar(20), `address` varchar(255) DEFAULT '' NOT NULL, `city` varchar(50), `state` varchar(10), `zip` varchar(10), `email_address` varchar(50) DEFAULT '' NOT NULL, `tax_id` varchar(255), `company` varchar(255), `is_enabled` tinyint(1) DEFAULT 0, `created_at` datetime) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (151.8ms)[0m   [0mCREATE TABLE `content_node_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(50) DEFAULT '' NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (128.4ms)[0m   [0mCREATE TABLE `content_nodes` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(200) DEFAULT '' NOT NULL, `title` varchar(100) DEFAULT '' NOT NULL, `content` text, `display_on` datetime NOT NULL, `created_on` datetime NOT NULL, `type` varchar(50) DEFAULT '' NOT NULL, `user_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mSHOW KEYS FROM `content_nodes`[0m
  [4;35;1mSQL (281.6ms)[0m   [0mCREATE INDEX `name` ON `content_nodes` (`name`)[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW KEYS FROM `content_nodes`[0m
  [4;35;1mSQL (257.6ms)[0m   [0mCREATE INDEX `type` ON `content_nodes` (`type`, `id`)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (118.7ms)[0m   [0mCREATE TABLE `content_nodes_sections` (`content_node_id` int(11) DEFAULT 0 NOT NULL, `section_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mSHOW KEYS FROM `content_nodes_sections`[0m
  [4;35;1mSQL (219.6ms)[0m   [0mCREATE INDEX `default` ON `content_nodes_sections` (`content_node_id`, `section_id`)[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (117.3ms)[0m   [0mCREATE TABLE `countries` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(100) DEFAULT '' NOT NULL, `code` varchar(50), `rank` int(11), `is_obsolete` tinyint(1) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (137.3ms)[0m   [0mCREATE TABLE `items` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `code` varchar(100) DEFAULT '' NOT NULL, `name` varchar(100) DEFAULT '' NOT NULL, `description` text, `price` float DEFAULT 0.0 NOT NULL, `date_available` datetime NOT NULL, `quantity` int(11) DEFAULT 0 NOT NULL, `size_width` float DEFAULT 0.0 NOT NULL, `size_height` float DEFAULT 0.0 NOT NULL, `size_depth` float DEFAULT 0.0 NOT NULL, `weight` float DEFAULT 0.0 NOT NULL, `type` varchar(40), `product_id` int(11) DEFAULT 0 NOT NULL, `is_discontinued` tinyint(1) DEFAULT 0 NOT NULL, `variation_quantity` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `items`[0m
  [4;35;1mSQL (241.1ms)[0m   [0mCREATE INDEX `tag_view` ON `items` (`date_available`, `is_discontinued`, `quantity`, `variation_quantity`, `type`)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW KEYS FROM `items`[0m
  [4;35;1mSQL (308.9ms)[0m   [0mCREATE INDEX `search` ON `items` (`name`, `code`, `is_discontinued`, `date_available`, `quantity`, `variation_quantity`, `type`)[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mSHOW KEYS FROM `items`[0m
  [4;35;1mSQL (251.8ms)[0m   [0mCREATE INDEX `variation` ON `items` (`product_id`, `type`)[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW KEYS FROM `items`[0m
  [4;35;1mSQL (218.3ms)[0m   [0mCREATE INDEX `published` ON `items` (`quantity`, `is_discontinued`, `variation_quantity`)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (117.9ms)[0m   [0mCREATE TABLE `order_account_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(30) DEFAULT '' NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (118.1ms)[0m   [0mCREATE TABLE `order_accounts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `order_user_id` int(11) DEFAULT 0 NOT NULL, `order_account_type_id` int(11) DEFAULT 1 NOT NULL, `cc_number` varchar(255), `account_number` varchar(255), `expiration_month` smallint, `expiration_year` int(11), `credit_ccv` bigint, `routing_number` varchar(20), `bank_name` varchar(50)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW KEYS FROM `order_accounts`[0m
  [4;35;1mSQL (230.4ms)[0m   [0mCREATE INDEX `ids` ON `order_accounts` (`order_user_id`, `order_account_type_id`)[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (126.0ms)[0m   [0mCREATE TABLE `order_addresses` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `order_user_id` int(11) DEFAULT 0 NOT NULL, `first_name` varchar(50) DEFAULT '' NOT NULL, `last_name` varchar(50) DEFAULT '' NOT NULL, `telephone` varchar(20), `address` varchar(255) DEFAULT '' NOT NULL, `city` varchar(50), `state` varchar(30), `zip` varchar(10), `country_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `order_addresses`[0m
  [4;35;1mSQL (253.8ms)[0m   [0mCREATE INDEX `countries` ON `order_addresses` (`country_id`, `order_user_id`)[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mSHOW KEYS FROM `order_addresses`[0m
  [4;35;1mSQL (230.6ms)[0m   [0mCREATE INDEX `name` ON `order_addresses` (`first_name`, `last_name`)[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (116.7ms)[0m   [0mCREATE TABLE `order_line_items` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `item_id` int(11), `order_id` int(11) DEFAULT 0 NOT NULL, `quantity` int(11) DEFAULT 0 NOT NULL, `unit_price` float DEFAULT 0.0 NOT NULL, `name` varchar(255) DEFAULT '') ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (117.9ms)[0m   [0mCREATE TABLE `order_shipping_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(100) DEFAULT '' NOT NULL, `code` varchar(50), `is_domestic` tinyint(1) DEFAULT 1 NOT NULL, `price` float DEFAULT 0.0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (139.2ms)[0m   [0mCREATE TABLE `order_shipping_weights` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `order_shipping_type_id` int(11) DEFAULT 0 NOT NULL, `min_weight` float DEFAULT 0.0 NOT NULL, `max_weight` float DEFAULT 0.0 NOT NULL, `price` float DEFAULT 0.0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (129.2ms)[0m   [0mCREATE TABLE `order_status_codes` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(30) DEFAULT '' NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `order_status_codes`[0m
  [4;35;1mSQL (263.9ms)[0m   [0mCREATE INDEX `name` ON `order_status_codes` (`name`)[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (116.4ms)[0m   [0mCREATE TABLE `order_users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `email_address` varchar(50) DEFAULT '' NOT NULL, `password` varchar(20), `created_on` datetime, `first_name` varchar(50) DEFAULT '' NOT NULL, `last_name` varchar(50) DEFAULT '' NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW KEYS FROM `order_users`[0m
  [4;35;1mSQL (296.4ms)[0m   [0mCREATE INDEX `email` ON `order_users` (`email_address`)[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (125.6ms)[0m   [0mCREATE TABLE `orders` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `order_number` int(11) DEFAULT 0 NOT NULL, `created_on` datetime, `shipped_on` datetime, `order_user_id` int(11), `order_status_code_id` int(11) DEFAULT 1 NOT NULL, `notes` text, `referer` varchar(255), `order_shipping_type_id` int(11) DEFAULT 1 NOT NULL, `product_cost` float DEFAULT 0.0, `shipping_cost` float DEFAULT 0.0, `tax` float DEFAULT 0.0 NOT NULL, `auth_transaction_id` varchar(255), `promotion_id` int(11) DEFAULT 0 NOT NULL, `shipping_address_id` int(11) DEFAULT 0 NOT NULL, `billing_address_id` int(11) DEFAULT 0 NOT NULL, `order_account_id` int(11) DEFAULT 0 NOT NULL, `affiliate_id` int(11) DEFAULT 0 NOT NULL, `affiliate_payment_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `orders`[0m
  [4;35;1mSQL (229.6ms)[0m   [0mCREATE INDEX `order_number` ON `orders` (`order_number`)[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mSHOW KEYS FROM `orders`[0m
  [4;35;1mSQL (229.9ms)[0m   [0mCREATE INDEX `status` ON `orders` (`order_status_code_id`)[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW KEYS FROM `orders`[0m
  [4;35;1mSQL (251.8ms)[0m   [0mCREATE INDEX `order_user_id` ON `orders` (`order_user_id`)[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (117.1ms)[0m   [0mCREATE TABLE `plugin_schema_info` (`plugin_name` varchar(255), `version` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (128.5ms)[0m   [0mCREATE TABLE `preferences` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) DEFAULT '' NOT NULL, `value` varchar(255) DEFAULT '') ENGINE=InnoDB[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mSHOW KEYS FROM `preferences`[0m
  [4;35;1mSQL (252.1ms)[0m   [0mCREATE INDEX `namevalue` ON `preferences` (`name`)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (461.7ms)[0m   [0mCREATE TABLE `product_downloads` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `download_id` int(11) DEFAULT 0 NOT NULL, `product_id` int(11) DEFAULT 0 NOT NULL, `rank` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW KEYS FROM `product_downloads`[0m
  [4;35;1mSQL (242.7ms)[0m   [0mCREATE INDEX `did` ON `product_downloads` (`download_id`)[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `product_downloads`[0m
  [4;35;1mSQL (241.4ms)[0m   [0mCREATE INDEX `pid` ON `product_downloads` (`product_id`)[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (129.0ms)[0m   [0mCREATE TABLE `product_images` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `image_id` int(11) DEFAULT 0 NOT NULL, `product_id` int(11) DEFAULT 0 NOT NULL, `rank` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mSHOW KEYS FROM `product_images`[0m
  [4;35;1mSQL (273.0ms)[0m   [0mCREATE INDEX `main` ON `product_images` (`product_id`, `image_id`)[0m
  [4;36;1mSQL (2.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (128.2ms)[0m   [0mCREATE TABLE `products_tags` (`product_id` int(11) DEFAULT 0 NOT NULL, `tag_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW KEYS FROM `products_tags`[0m
  [4;35;1mSQL (241.0ms)[0m   [0mCREATE INDEX `product_tags` ON `products_tags` (`product_id`, `tag_id`)[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (115.8ms)[0m   [0mCREATE TABLE `promotions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `code` varchar(15) DEFAULT '' NOT NULL, `discount_type` int(11) DEFAULT 0 NOT NULL, `discount_amount` float DEFAULT 0.0 NOT NULL, `item_id` int(11), `start` datetime NOT NULL, `end` datetime NOT NULL, `minimum_cart_value` float, `description` varchar(255) DEFAULT '' NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (116.9ms)[0m   [0mCREATE TABLE `questions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `short_question` varchar(255), `long_question` text, `answer` text, `rank` int(11), `featured` tinyint(1) DEFAULT 0 NOT NULL, `times_viewed` int(11) DEFAULT 0 NOT NULL, `created_on` datetime NOT NULL, `answered_on` datetime, `email_address` varchar(50)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (118.4ms)[0m   [0mCREATE TABLE `related_products` (`product_id` int(11) DEFAULT 0 NOT NULL, `related_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW KEYS FROM `related_products`[0m
  [4;35;1mSQL (254.4ms)[0m   [0mCREATE INDEX `related_products` ON `related_products` (`product_id`, `related_id`)[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (137.4ms)[0m   [0mCREATE TABLE `rights` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `controller` varchar(255), `actions` varchar(255)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (151.2ms)[0m   [0mCREATE TABLE `rights_roles` (`right_id` int(11), `role_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (128.0ms)[0m   [0mCREATE TABLE `roles` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `description` text) ENGINE=InnoDB[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (150.9ms)[0m   [0mCREATE TABLE `roles_users` (`role_id` int(11), `user_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (128.6ms)[0m   [0mCREATE TABLE `sections` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(100) DEFAULT '' NOT NULL, `rank` int(11), `parent_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (2.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (127.2ms)[0m   [0mCREATE TABLE `sessions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sessid` varchar(255) DEFAULT '' NOT NULL, `data` text, `updated_at` datetime, `created_at` datetime) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW KEYS FROM `sessions`[0m
  [4;35;1mSQL (241.2ms)[0m   [0mCREATE INDEX `session_index` ON `sessions` (`sessid`)[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (139.5ms)[0m   [0mCREATE TABLE `tags` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(100) DEFAULT '' NOT NULL, `rank` int(11), `parent_id` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `tags`[0m
  [4;35;1mSQL (506.4ms)[0m   [0mCREATE INDEX `name` ON `tags` (`name`)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (249.0ms)[0m   [0mCREATE TABLE `user_uploads` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `filename` varchar(255), `width` int(11) DEFAULT 0 NOT NULL, `height` int(11) DEFAULT 0 NOT NULL, `type` varchar(255), `created_on` datetime, `parent_id` int(11), `content_type` varchar(255), `thumbnail` varchar(255), `size` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW KEYS FROM `user_uploads`[0m
  [4;35;1mSQL (639.7ms)[0m   [0mCREATE INDEX `creation` ON `user_uploads` (`created_on`, `type`)[0m
  [4;36;1mSQL (2.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (315.1ms)[0m   [0mCREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `login` varchar(50) DEFAULT '' NOT NULL, `password` varchar(40)) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mSHOW KEYS FROM `users`[0m
  [4;35;1mSQL (241.5ms)[0m   [0mCREATE INDEX `login` ON `users` (`login`, `password`)[0m
  [4;36;1mSQL (3.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (126.0ms)[0m   [0mCREATE TABLE `wishlist_items` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `order_user_id` int(11) DEFAULT 0 NOT NULL, `item_id` int(11) DEFAULT 0 NOT NULL, `created_on` datetime) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mSHOW KEYS FROM `wishlist_items`[0m
  [4;35;1mSQL (265.2ms)[0m   [0mCREATE INDEX `item` ON `wishlist_items` (`item_id`)[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mSHOW KEYS FROM `wishlist_items`[0m
  [4;35;1mSQL (252.1ms)[0m   [0mCREATE INDEX `user` ON `wishlist_items` (`order_user_id`)[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (139.5ms)[0m   [0mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW KEYS FROM `schema_migrations`[0m
  [4;35;1mSQL (264.5ms)[0m   [0mCREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`)[0m
  [4;36;1mSQL (2.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (25.3ms)[0m   [0mSELECT version FROM `schema_migrations`[0m
  [4;36;1mSQL (46.4ms)[0m   [0;1mINSERT INTO `schema_migrations` (version) VALUES ('20100210194537')[0m
  [4;35;1mContentNode Load (3.5ms)[0m   [0mSELECT * FROM `content_nodes` [0m
  [4;36;1mCountry Load (2.9ms)[0m   [0;1mSELECT * FROM `countries` [0m
  [4;35;1mPreference Load (0.2ms)[0m   [0mSELECT * FROM `preferences` [0m
  [4;36;1mOrderShippingType Load (0.7ms)[0m   [0;1mSELECT * FROM `order_shipping_types` [0m
  [4;35;1mOrderShippingWeight Load (1.2ms)[0m   [0mSELECT * FROM `order_shipping_weights` [0m
  [4;36;1mOrderStatusCode Load (0.4ms)[0m   [0;1mSELECT * FROM `order_status_codes` [0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` [0m
  [4;35;1mSession Load (0.4ms)[0m   [0mSELECT * FROM `sessions` [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1m
 DELETE from schema_migrations
 WHERE version LIKE "%-substruct"
 [0m
  [4;35;1mSQL (52.0ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('1-substruct');
 [0m
  [4;36;1mSQL (55.1ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('2-substruct');
 [0m
  [4;35;1mSQL (55.0ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('3-substruct');
 [0m
  [4;36;1mSQL (54.9ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('4-substruct');
 [0m
  [4;35;1mSQL (55.3ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('5-substruct');
 [0m
  [4;36;1mSQL (54.8ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('6-substruct');
 [0m
  [4;35;1mSQL (54.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('7-substruct');
 [0m
  [4;36;1mSQL (54.8ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('8-substruct');
 [0m
  [4;35;1mSQL (43.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('9-substruct');
 [0m
  [4;36;1mSQL (43.9ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('10-substruct');
 [0m
  [4;35;1mSQL (43.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('11-substruct');
 [0m
  [4;36;1mSQL (43.8ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('12-substruct');
 [0m
  [4;35;1mSQL (44.1ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('13-substruct');
 [0m
  [4;36;1mSQL (44.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('14-substruct');
 [0m
  [4;35;1mSQL (43.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('15-substruct');
 [0m
  [4;36;1mSQL (44.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('16-substruct');
 [0m
  [4;35;1mSQL (55.0ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('17-substruct');
 [0m
  [4;36;1mSQL (54.9ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('18-substruct');
 [0m
  [4;35;1mSQL (44.0ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('19-substruct');
 [0m
  [4;36;1mSQL (44.3ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('20-substruct');
 [0m
  [4;35;1mSQL (54.8ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('21-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('22-substruct');
 [0m
  [4;35;1mSQL (54.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('23-substruct');
 [0m
  [4;36;1mSQL (54.9ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('24-substruct');
 [0m
  [4;35;1mSQL (54.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('25-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('26-substruct');
 [0m
  [4;35;1mSQL (54.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('27-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('28-substruct');
 [0m
  [4;35;1mSQL (54.9ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('29-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('30-substruct');
 [0m
  [4;35;1mSQL (55.4ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('31-substruct');
 [0m
  [4;36;1mSQL (56.3ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('32-substruct');
 [0m
  [4;35;1mSQL (53.4ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('33-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('34-substruct');
 [0m
  [4;35;1mSQL (56.6ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('35-substruct');
 [0m
  [4;36;1mSQL (55.1ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('36-substruct');
 [0m
  [4;35;1mSQL (132.2ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('37-substruct');
 [0m
  [4;36;1mSQL (55.0ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('38-substruct');
 [0m
  [4;35;1mSQL (55.2ms)[0m   [0m
 INSERT INTO schema_migrations
 VALUES('39-substruct');
 [0m
  [4;36;1mSQL (55.1ms)[0m   [0;1m
 INSERT INTO schema_migrations
 VALUES('40-substruct');
 [0m
  [4;36;1mPreference Load (1.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (4.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (5.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m


Processing ContentNodesController#show_by_name (for 127.0.0.1 at 2011-02-08 19:15:51) [GET]
  Parameters: {"name"=>"home"}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mSection Load (0.8ms)[0m   [0mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mContentNode Load (0.7ms)[0m   [0;1mSELECT * FROM `content_nodes` WHERE (name = 'home') LIMIT 1[0m
Rendering template within layouts/main
Rendering content_nodes/show_by_name
Rendered shared/_flash (1.7ms)
Completed in 170ms (View: 79, DB: 4) | 200 OK [http://localhost/]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-08 19:15:58) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.5ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;36;1mProduct Load (24.2ms)[0m   [0;1mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
Rendered shared/_flash (0.2ms)
Completed in 281ms (View: 162, DB: 30) | 200 OK [http://localhost/store]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:16:04) [GET]
  Parameters: {"tags"=>["On Sale"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.2ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.5ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'On Sale') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 1) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.7ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (1) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mProduct Load (1.5ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (1) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 1) [0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered shared/_flash (0.2ms)
Completed in 234ms (View: 14, DB: 8) | 200 OK [http://localhost/store/s/On%20Sale]


Processing ContentNodesController#index (for 127.0.0.1 at 2011-02-08 19:16:07) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mSection Load (0.6ms)[0m   [0;1mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mBlog Load (0.8ms)[0m   [0mSELECT * FROM `content_nodes` WHERE (display_on <= CURRENT_DATE) AND ( (`content_nodes`.`type` = 'Blog' ) ) ORDER BY display_on DESC, created_on DESC LIMIT 0, 5[0m
Rendering template within layouts/main
Rendering content_nodes/index
Rendered content_nodes/_section_list (1.3ms)
Rendered shared/_flash (0.1ms)
Completed in 128ms (View: 59, DB: 4) | 200 OK [http://localhost/blog]


Processing ContentNodesController#show_by_name (for 127.0.0.1 at 2011-02-08 19:16:12) [GET]
  Parameters: {"name"=>"home"}
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mSection Load (0.6ms)[0m   [0mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mContentNode Load (0.7ms)[0m   [0;1mSELECT * FROM `content_nodes` WHERE (name = 'home') LIMIT 1[0m
Rendering template within layouts/main
Rendering content_nodes/show_by_name
Rendered shared/_flash (0.2ms)
Completed in 89ms (View: 15, DB: 4) | 200 OK [http://localhost/]


Processing ContentNodesController#show_by_name (for 127.0.0.1 at 2011-02-08 19:17:09) [GET]
  Parameters: {"name"=>"dmin"}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (1.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mSection Load (0.6ms)[0m   [0;1mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mContentNode Load (0.7ms)[0m   [0mSELECT * FROM `content_nodes` WHERE (name = 'dmin') LIMIT 1[0m
Rendering /home/amit/substruct_rel_1-3-1/public/404.html (404)
Completed in 82ms (View: 25, DB: 5) | 404 Not Found [http://localhost/dmin]


Processing Admin::OrdersController#index (for 127.0.0.1 at 2011-02-08 19:17:13) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
Redirected to http://localhost:3000/accounts/login
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 19ms (DB: 2) | 302 Found [http://localhost/admin]


Processing AccountsController#login (for 127.0.0.1 at 2011-02-08 19:17:13) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
Rendering template within layouts/accounts
Rendering accounts/login
Completed in 76ms (View: 43, DB: 2) | 200 OK [http://localhost/accounts/login]


Processing AccountsController#login (for 127.0.0.1 at 2011-02-08 19:17:22) [POST]
  Parameters: {"user_login"=>"admin", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "user_password"=>"admin", "login"=>"Login"}
  [4;36;1mPreference Load (5.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (3.5ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (2.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'admin' AND password = '652b1b54a914207f0cfd15de1967d8ebe26c1b94') LIMIT 1[0m
Redirected to http://localhost:3000/admin
Completed in 96ms (DB: 13) | 302 Found [http://localhost/accounts/login]


Processing Admin::OrdersController#index (for 127.0.0.1 at 2011-02-08 19:17:23) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mOrder Load (0.9ms)[0m   [0;1mSELECT * FROM `orders` WHERE (order_status_code_id = 5) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/orders/list
Rendered admin/orders/_search (18.0ms)
Rendered admin/orders/_right_side (40.6ms)
Completed in 149ms (View: 105, DB: 4) | 200 OK [http://localhost/admin]


Processing Admin::ProductsController#index (for 127.0.0.1 at 2011-02-08 19:17:30) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/products/list
  [4;35;1mSQL (26.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (37.3ms)
Rendered admin/products/_tag_list_view_item (47.0ms)
Rendered admin/products/_right_side (61.6ms)
Completed in 318ms (View: 75, DB: 30) | 200 OK [http://localhost/admin/products]


Processing Admin::OrdersController#index (for 127.0.0.1 at 2011-02-08 19:17:39) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT * FROM `orders` WHERE (order_status_code_id = 5) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/orders/list
Rendered admin/orders/_search (5.3ms)
Rendered admin/orders/_right_side (6.6ms)
Completed in 68ms (View: 26, DB: 4) | 200 OK [http://localhost/admin/orders]


Processing Admin::ContentNodesController#index (for 127.0.0.1 at 2011-02-08 19:17:51) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSection Load (0.6ms)[0m   [0mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mContentNode Load (0.9ms)[0m   [0;1mSELECT * FROM `content_nodes` WHERE (type = 'Blog') ORDER BY created_on DESC LIMIT 0, 10[0m
Rendering template within layouts/admin
Rendering admin/content_nodes/list
Rendered admin/content_nodes/_subnav (8.7ms)
  [4;35;1mSection Load (0.5ms)[0m   [0mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 79336530 ) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
  [4;35;1mSection Load (0.4ms)[0m   [0mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 989995836 ) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
  [4;35;1mSection Load (0.7ms)[0m   [0mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 972815062 ) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
Rendered admin/content_nodes/_content_right_side (2.8ms)
Completed in 290ms (View: 84, DB: 6) | 200 OK [http://localhost/admin/content_nodes]


Processing Admin::FilesController#index (for 127.0.0.1 at 2011-02-08 19:17:57) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mUserUpload Load (0.6ms)[0m   [0mSELECT * FROM `user_uploads` WHERE (thumbnail is NULL) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/files/index
Rendered shared/_multiple_upload (2.1ms)
Rendered admin/content_nodes/_subnav (148.2ms)
Completed in 251ms (View: 194, DB: 3) | 200 OK [http://localhost/admin/files]


Processing Admin::FilesController#index (for 127.0.0.1 at 2011-02-08 19:18:02) [GET]
  Parameters: {"key"=>"Image"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mUserUpload Load (1.0ms)[0m   [0;1mSELECT * FROM `user_uploads` WHERE (type = 'Image' and thumbnail is NULL) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/files/index
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/content_nodes/_subnav (15.2ms)
Completed in 101ms (View: 39, DB: 4) | 200 OK [http://localhost/admin/files?key=Image]


Processing Admin::AffiliatesController#index (for 127.0.0.1 at 2011-02-08 19:18:11) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mAffiliate Load (0.8ms)[0m   [0mSELECT * FROM `affiliates` ORDER BY created_at DESC[0m
Rendering template within layouts/admin
Rendering admin/affiliates/list
Rendered admin/affiliates/_subnav_list (2.7ms)
Rendered admin/affiliates/_right_side (3.1ms)
Completed in 117ms (View: 49, DB: 3) | 200 OK [http://localhost/admin/affiliates]


Processing Admin::PromotionsController#index (for 127.0.0.1 at 2011-02-08 19:18:18) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` ORDER BY code ASC[0m
Rendering template within layouts/admin
Rendering admin/promotions/list
Rendered admin/promotions/_subnav (1.1ms)
Rendered admin/promotions/_right_side (5.4ms)
Completed in 136ms (View: 70, DB: 4) | 200 OK [http://localhost/admin/promotions]


Processing Admin::PromotionsController#index (for 127.0.0.1 at 2011-02-08 19:18:18) [GET]
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (3.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (3.1ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` ORDER BY code ASC[0m
Rendering template within layouts/admin
Rendering admin/promotions/list
Rendered admin/promotions/_subnav (0.1ms)
Rendered admin/promotions/_right_side (0.7ms)
Completed in 143ms (View: 30, DB: 12) | 200 OK [http://localhost/admin/promotions]


Processing Admin::OrdersController#index (for 127.0.0.1 at 2011-02-08 19:18:25) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT * FROM `orders` WHERE (order_status_code_id = 5) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/orders/list
Rendered admin/orders/_search (7.1ms)
Rendered admin/orders/_right_side (8.4ms)
Completed in 62ms (View: 25, DB: 3) | 200 OK [http://localhost/admin/orders]


Processing Admin::PreferencesController#index (for 127.0.0.1 at 2011-02-08 19:18:35) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` [0m
Rendering template within layouts/admin
Rendering admin/preferences/index
Start rendering component ({:action=>"complete_select_list", :controller=>"countries", :params=>{:selected=>"880262049", :select_name=>"prefs[store_home_country]"}}): 


Processing CountriesController#complete_select_list (for 127.0.0.1 at 2011-02-08 19:18:35) [GET]
  Parameters: {"selected"=>"880262049", "select_name"=>"prefs[store_home_country]", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mCountry Load (2.3ms)[0m   [0mSELECT * FROM `countries` ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 40ms (View: 18, DB: 2) | 200 OK [http://localhost/admin/preferences]


End of component rendering
Rendered admin/preferences/_sidebar (6.1ms)
Completed in 185ms (View: 129, DB: 3) | 200 OK [http://localhost/admin/preferences]


Processing Admin::PreferencesController#save_prefs (for 127.0.0.1 at 2011-02-08 19:18:56) [POST]
  Parameters: {"commit"=>"Save Preferences", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "prefs"=>{"mail_port"=>"25", "store_name"=>"Pragtech", "cc_processor"=>"Authorize.net", "mail_auth_type"=>"none", "store_home_country"=>{"country_id"=>"880262049"}, "mail_password"=>"", "store_show_confirmation"=>"1", "store_handling_fee"=>"0.00", "cc_clear_after_order"=>"1", "mail_host"=>"localhost", "cc_pass"=>"", "store_test_transactions"=>"1", "store_require_login"=>"0", "store_use_inventory_control"=>"1", "mail_copy_to"=>"", "mail_username"=>"", "affiliate_revenue_percentage"=>"5", "use_smtp_tls_patch"=>"0", "affiliate_paid_order_delay"=>"90", "cc_login"=>""}}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.1ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
SERVER SETTINGS...
{"store_name"=>"Pragtech", "mail_port"=>"25", "cc_processor"=>"Authorize.net", "store_home_country"=>"880262049", "mail_auth_type"=>"none", "store_handling_fee"=>"0.00", "store_show_confirmation"=>"1", "mail_password"=>"", "cc_clear_after_order"=>"1", "cc_pass"=>"", "mail_host"=>"localhost", "store_use_inventory_control"=>"1", "store_require_login"=>"0", "store_test_transactions"=>"1", "mail_copy_to"=>"", "affiliate_revenue_percentage"=>"5", "mail_username"=>"", "cc_login"=>"", "affiliate_paid_order_delay"=>"90", "use_smtp_tls_patch"=>"0"}
  [4;35;1mPreference Update (49.0ms)[0m   [0mUPDATE `preferences` SET value = 'Pragtech' WHERE (name = 'store_name') [0m
  [4;36;1mPreference Update (42.2ms)[0m   [0;1mUPDATE `preferences` SET value = '25' WHERE (name = 'mail_port') [0m
  [4;35;1mPreference Update (41.8ms)[0m   [0mUPDATE `preferences` SET value = 'Authorize.net' WHERE (name = 'cc_processor') [0m
  [4;36;1mPreference Update (42.7ms)[0m   [0;1mUPDATE `preferences` SET value = '880262049' WHERE (name = 'store_home_country') [0m
  [4;35;1mPreference Update (42.9ms)[0m   [0mUPDATE `preferences` SET value = 'none' WHERE (name = 'mail_auth_type') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '0.00' WHERE (name = 'store_handling_fee') [0m
  [4;35;1mPreference Update (53.8ms)[0m   [0mUPDATE `preferences` SET value = '1' WHERE (name = 'store_show_confirmation') [0m
  [4;36;1mPreference Update (53.7ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'mail_password') [0m
  [4;35;1mPreference Update (53.9ms)[0m   [0mUPDATE `preferences` SET value = '1' WHERE (name = 'cc_clear_after_order') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'cc_pass') [0m
  [4;35;1mPreference Update (53.7ms)[0m   [0mUPDATE `preferences` SET value = 'localhost' WHERE (name = 'mail_host') [0m
  [4;36;1mPreference Update (54.8ms)[0m   [0;1mUPDATE `preferences` SET value = '1' WHERE (name = 'store_use_inventory_control') [0m
  [4;35;1mPreference Update (67.4ms)[0m   [0mUPDATE `preferences` SET value = '0' WHERE (name = 'store_require_login') [0m
  [4;36;1mPreference Update (65.3ms)[0m   [0;1mUPDATE `preferences` SET value = '1' WHERE (name = 'store_test_transactions') [0m
  [4;35;1mPreference Update (53.8ms)[0m   [0mUPDATE `preferences` SET value = '' WHERE (name = 'mail_copy_to') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '5' WHERE (name = 'affiliate_revenue_percentage') [0m
  [4;35;1mPreference Update (53.9ms)[0m   [0mUPDATE `preferences` SET value = '' WHERE (name = 'mail_username') [0m
  [4;36;1mPreference Update (53.8ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'cc_login') [0m
  [4;35;1mPreference Update (53.9ms)[0m   [0mUPDATE `preferences` SET value = '90' WHERE (name = 'affiliate_paid_order_delay') [0m
  [4;36;1mPreference Update (54.2ms)[0m   [0;1mUPDATE `preferences` SET value = '0' WHERE (name = 'use_smtp_tls_patch') [0m
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
Redirected to http://localhost:3000/admin/preferences
Completed in 1187ms (DB: 1059) | 302 Found [http://localhost/admin/preferences/save_prefs]


Processing Admin::PreferencesController#index (for 127.0.0.1 at 2011-02-08 19:18:57) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` [0m
Rendering template within layouts/admin
Rendering admin/preferences/index
Start rendering component ({:action=>"complete_select_list", :controller=>"countries", :params=>{:selected=>"880262049", :select_name=>"prefs[store_home_country]"}}): 


Processing CountriesController#complete_select_list (for 127.0.0.1 at 2011-02-08 19:18:57) [GET]
  Parameters: {"selected"=>"880262049", "select_name"=>"prefs[store_home_country]", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mCountry Load (2.4ms)[0m   [0mSELECT * FROM `countries` ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 161ms (View: 9, DB: 2) | 200 OK [http://localhost/admin/preferences]


End of component rendering
Rendered admin/preferences/_sidebar (5.3ms)
Completed in 256ms (View: 204, DB: 3) | 200 OK [http://localhost/admin/preferences]


Processing Admin::PreferencesController#save_prefs (for 127.0.0.1 at 2011-02-08 19:19:08) [POST]
  Parameters: {"commit"=>"Save Preferences", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "prefs"=>{"mail_port"=>"25", "store_name"=>"Pragtech", "cc_processor"=>"Authorize.net", "mail_auth_type"=>"none", "store_home_country"=>{"country_id"=>"880262049"}, "mail_password"=>"", "store_show_confirmation"=>"1", "store_handling_fee"=>"0.00", "cc_clear_after_order"=>"1", "mail_host"=>"localhost", "cc_pass"=>"", "store_test_transactions"=>"1", "store_require_login"=>"0", "store_use_inventory_control"=>"1", "mail_copy_to"=>"", "mail_username"=>"", "affiliate_revenue_percentage"=>"5", "use_smtp_tls_patch"=>"0", "affiliate_paid_order_delay"=>"90", "cc_login"=>""}}
  [4;36;1mPreference Load (4.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (2.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.8ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
SERVER SETTINGS...
{"store_name"=>"Pragtech", "mail_port"=>"25", "cc_processor"=>"Authorize.net", "store_home_country"=>"880262049", "mail_auth_type"=>"none", "store_handling_fee"=>"0.00", "store_show_confirmation"=>"1", "mail_password"=>"", "cc_clear_after_order"=>"1", "cc_pass"=>"", "mail_host"=>"localhost", "store_use_inventory_control"=>"1", "store_require_login"=>"0", "store_test_transactions"=>"1", "mail_copy_to"=>"", "affiliate_revenue_percentage"=>"5", "mail_username"=>"", "cc_login"=>"", "affiliate_paid_order_delay"=>"90", "use_smtp_tls_patch"=>"0"}
  [4;35;1mPreference Update (49.5ms)[0m   [0mUPDATE `preferences` SET value = 'Pragtech' WHERE (name = 'store_name') [0m
  [4;36;1mPreference Update (42.6ms)[0m   [0;1mUPDATE `preferences` SET value = '25' WHERE (name = 'mail_port') [0m
  [4;35;1mPreference Update (54.0ms)[0m   [0mUPDATE `preferences` SET value = 'Authorize.net' WHERE (name = 'cc_processor') [0m
  [4;36;1mPreference Update (53.5ms)[0m   [0;1mUPDATE `preferences` SET value = '880262049' WHERE (name = 'store_home_country') [0m
  [4;35;1mPreference Update (53.9ms)[0m   [0mUPDATE `preferences` SET value = 'none' WHERE (name = 'mail_auth_type') [0m
  [4;36;1mPreference Update (54.0ms)[0m   [0;1mUPDATE `preferences` SET value = '0.00' WHERE (name = 'store_handling_fee') [0m
  [4;35;1mPreference Update (53.7ms)[0m   [0mUPDATE `preferences` SET value = '1' WHERE (name = 'store_show_confirmation') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'mail_password') [0m
  [4;35;1mPreference Update (53.8ms)[0m   [0mUPDATE `preferences` SET value = '1' WHERE (name = 'cc_clear_after_order') [0m
  [4;36;1mPreference Update (54.2ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'cc_pass') [0m
  [4;35;1mPreference Update (53.4ms)[0m   [0mUPDATE `preferences` SET value = 'localhost' WHERE (name = 'mail_host') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '1' WHERE (name = 'store_use_inventory_control') [0m
  [4;35;1mPreference Update (52.9ms)[0m   [0mUPDATE `preferences` SET value = '0' WHERE (name = 'store_require_login') [0m
  [4;36;1mPreference Update (54.1ms)[0m   [0;1mUPDATE `preferences` SET value = '1' WHERE (name = 'store_test_transactions') [0m
  [4;35;1mPreference Update (53.8ms)[0m   [0mUPDATE `preferences` SET value = '' WHERE (name = 'mail_copy_to') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '5' WHERE (name = 'affiliate_revenue_percentage') [0m
  [4;35;1mPreference Update (54.8ms)[0m   [0mUPDATE `preferences` SET value = '' WHERE (name = 'mail_username') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '' WHERE (name = 'cc_login') [0m
  [4;35;1mPreference Update (53.7ms)[0m   [0mUPDATE `preferences` SET value = '90' WHERE (name = 'affiliate_paid_order_delay') [0m
  [4;36;1mPreference Update (53.9ms)[0m   [0;1mUPDATE `preferences` SET value = '0' WHERE (name = 'use_smtp_tls_patch') [0m
  [4;35;1mPreference Load (1.2ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
Redirected to http://localhost:3000/admin/preferences
Completed in 1214ms (DB: 1076) | 302 Found [http://localhost/admin/preferences/save_prefs]


Processing Admin::PreferencesController#index (for 127.0.0.1 at 2011-02-08 19:19:10) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (3.9ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` [0m
Rendering template within layouts/admin
Rendering admin/preferences/index
Start rendering component ({:action=>"complete_select_list", :controller=>"countries", :params=>{:selected=>"880262049", :select_name=>"prefs[store_home_country]"}}): 


Processing CountriesController#complete_select_list (for 127.0.0.1 at 2011-02-08 19:19:10) [GET]
  Parameters: {"selected"=>"880262049", "select_name"=>"prefs[store_home_country]", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mCountry Load (2.5ms)[0m   [0mSELECT * FROM `countries` ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 35ms (View: 9, DB: 2) | 200 OK [http://localhost/admin/preferences]


End of component rendering
Rendered admin/preferences/_sidebar (3.7ms)
Completed in 146ms (View: 82, DB: 7) | 200 OK [http://localhost/admin/preferences]


Processing Admin::PreferencesController#index (for 127.0.0.1 at 2011-02-08 19:19:14) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (20.6ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` [0m
Rendering template within layouts/admin
Rendering admin/preferences/index
Start rendering component ({:action=>"complete_select_list", :controller=>"countries", :params=>{:selected=>"880262049", :select_name=>"prefs[store_home_country]"}}): 


Processing CountriesController#complete_select_list (for 127.0.0.1 at 2011-02-08 19:19:15) [GET]
  Parameters: {"selected"=>"880262049", "select_name"=>"prefs[store_home_country]", "id"=>nil}
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mCountry Load (2.3ms)[0m   [0;1mSELECT * FROM `countries` ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 34ms (View: 9, DB: 2) | 200 OK [http://localhost/admin/preferences]


End of component rendering
Rendered admin/preferences/_sidebar (3.8ms)
Completed in 260ms (View: 79, DB: 23) | 200 OK [http://localhost/admin/preferences]


Processing Admin::TagsController#list (for 127.0.0.1 at 2011-02-08 19:19:23) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.8ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
[AUTH] promotions - *
[AUTH] questions - *
[AUTH] rights - *
[AUTH] roles - *
[AUTH] sections - *
[AUTH] tags - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
Rendering template within layouts/admin
Rendering admin/tags/list
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 0) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tags` WHERE (`tags`.parent_id = 1) [0m
Rendered admin/tags/_tag_list_row (21.1ms)
Rendered admin/preferences/_sidebar (3.5ms)
Completed in 297ms (View: 218, DB: 5) | 200 OK [http://localhost/admin/tags/list]


Processing Admin::TagsController#create (for 127.0.0.1 at 2011-02-08 19:19:28) [POST]
  Parameters: {"commit"=>"Save New Tag", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "tag"=>{"name"=>""}}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.9ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
[AUTH] promotions - *
[AUTH] questions - *
[AUTH] rights - *
[AUTH] roles - *
[AUTH] sections - *
[AUTH] tags - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT `tags`.id FROM `tags` WHERE (`tags`.`name` = BINARY '') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
Completed in 83ms (View: 1, DB: 5) | 200 OK [http://localhost/admin/tags/create]


Processing Admin::TagsController#create (for 127.0.0.1 at 2011-02-08 19:19:38) [POST]
  Parameters: {"commit"=>"Save New Tag", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "tag"=>{"name"=>"T-Shirt"}}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.9ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
[AUTH] promotions - *
[AUTH] questions - *
[AUTH] rights - *
[AUTH] roles - *
[AUTH] sections - *
[AUTH] tags - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT `tags`.id FROM `tags` WHERE (`tags`.`name` = BINARY 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Create (0.3ms)[0m   [0;1mINSERT INTO `tags` (`name`, `rank`, `parent_id`) VALUES('T-Shirt', NULL, 0)[0m
  [4;35;1mSQL (39.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 0) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tags` WHERE (`tags`.parent_id = 2) [0m
Rendered admin/tags/_tag_list_row (18.4ms)
Completed in 153ms (View: 20, DB: 46) | 200 OK [http://localhost/admin/tags/create]


Processing Admin::SectionsController#list (for 127.0.0.1 at 2011-02-08 19:19:44) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (1.1ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
[AUTH] promotions - *
[AUTH] questions - *
[AUTH] rights - *
[AUTH] roles - *
[AUTH] sections - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSection Load (0.6ms)[0m   [0mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
Rendering template within layouts/admin
Rendering admin/sections/list
Rendered admin/preferences/_sidebar (3.6ms)
Completed in 289ms (View: 197, DB: 5) | 200 OK [http://localhost/admin/sections/list]


Processing Admin::PreferencesController#index (for 127.0.0.1 at 2011-02-08 19:19:48) [GET]
  [4;36;1mPreference Load (2.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` [0m
Rendering template within layouts/admin
Rendering admin/preferences/index
Start rendering component ({:action=>"complete_select_list", :controller=>"countries", :params=>{:selected=>"880262049", :select_name=>"prefs[store_home_country]"}}): 


Processing CountriesController#complete_select_list (for 127.0.0.1 at 2011-02-08 19:19:48) [GET]
  Parameters: {"selected"=>"880262049", "select_name"=>"prefs[store_home_country]", "id"=>nil}
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mCountry Load (2.7ms)[0m   [0;1mSELECT * FROM `countries` ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 33ms (View: 8, DB: 3) | 200 OK [http://localhost/admin/preferences]


End of component rendering
Rendered admin/preferences/_sidebar (3.4ms)
Completed in 137ms (View: 78, DB: 9) | 200 OK [http://localhost/admin/preferences]


Processing Admin::ProductsController#index (for 127.0.0.1 at 2011-02-08 19:19:52) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/products/list
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (5.9ms)
Rendered admin/products/_tag_list_view_item (6.5ms)
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 2 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (5.8ms)
Rendered admin/products/_tag_list_view_item (6.2ms)
Rendered admin/products/_right_side (16.3ms)
Completed in 113ms (View: 29, DB: 4) | 200 OK [http://localhost/admin/products]


Processing Admin::ProductsController#new (for 127.0.0.1 at 2011-02-08 19:20:02) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.9ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.9ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
Rendering template within layouts/admin
Rendering admin/products/new
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_image_upload (12.2ms)
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_product_upload (14.0ms)
Rendered admin/products/_form (288.3ms)
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = NULL ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = NULL ) LIMIT 1[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (12.5ms)
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = NULL ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = NULL ) LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (5.4ms)
Rendered admin/products/_relative (1.8ms)
Rendered admin/products/_relative (2.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (45.3ms)
Completed in 830ms (View: 374, DB: 7) | 200 OK [http://localhost/admin/products/new]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:20:03) [GET]
  [4;35;1mPreference Load (4.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (5.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (2.0ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.8ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (1.0ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (4.9ms)[0m   [0mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 530ms (View: 18, DB: 21) | 200 OK [http://localhost/admin/products/suggestion_js]


Processing Admin::ProductsController#add_variation_ajax (for 127.0.0.1 at 2011-02-08 19:20:22) [POST]
  Parameters: {"authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM="}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (6.5ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (1.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m

ActionView::TemplateError (undefined method `variation_rank' for #<Variation:0xb6cdfdc8>) on line #3 of vendor/plugins/substruct/app/views/admin/products/_variation.rhtml:
1: <div class="variation sort_item" id="variation_<%= variation.id %>">
2: 	<input type="hidden" name="variation[][id]" value="<%= variation.id %>" />
3: 	<input type="hidden" name="variation[][variation_rank]" value="<%= variation.variation_rank %>" />
4: 	<div class="float">
5: 		<%= make_label('Name', true) %>
6: 		<%= text_field_tag('variation[][name]', variation.short_name, :size => 30, :class => 'textInput') %>

    vendor/plugins/substruct/app/views/admin/products/_variation.rhtml:3:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47products47_variation46rhtml_locals_object_variation'
    vendor/plugins/substruct/app/controllers/admin/products_controller.rb:220:in `add_variation_ajax'
    vendor/plugins/substruct/app/controllers/admin/products_controller.rb:219:in `add_variation_ajax'

Rendered rescues/_trace (123.8ms)
Rendered rescues/_request_and_response (2.2ms)
Rendering rescues/layout (internal_server_error)


Processing Admin::ProductsController#add_variation_ajax (for 127.0.0.1 at 2011-02-08 19:20:29) [POST]
  Parameters: {"authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM="}
  [4;36;1mPreference Load (2.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.7ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.9ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m

ActionView::TemplateError (undefined method `variation_rank' for #<Variation:0xb6fa515c>) on line #3 of vendor/plugins/substruct/app/views/admin/products/_variation.rhtml:
1: <div class="variation sort_item" id="variation_<%= variation.id %>">
2: 	<input type="hidden" name="variation[][id]" value="<%= variation.id %>" />
3: 	<input type="hidden" name="variation[][variation_rank]" value="<%= variation.variation_rank %>" />
4: 	<div class="float">
5: 		<%= make_label('Name', true) %>
6: 		<%= text_field_tag('variation[][name]', variation.short_name, :size => 30, :class => 'textInput') %>

    vendor/plugins/substruct/app/views/admin/products/_variation.rhtml:3:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47products47_variation46rhtml_locals_object_variation'
    vendor/plugins/substruct/app/controllers/admin/products_controller.rb:220:in `add_variation_ajax'
    vendor/plugins/substruct/app/controllers/admin/products_controller.rb:219:in `add_variation_ajax'

Rendered rescues/_trace (87.0ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)


Processing Admin::ProductsController#save (for 127.0.0.1 at 2011-02-08 19:21:18) [POST]
  Parameters: {"download"=>[{"download_data_temp"=>""}, {"download_data_temp"=>""}], "commit"=>"Save New Product", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "product"=>{"related_product_ids"=>["", "", "", "", ""], "price"=>"450.00", "name"=>"Amit", "quantity"=>"5", "code"=>"A001", "weight"=>"20T", "date_available(1i)"=>"2011", "date_available(2i)"=>"2", "size_height"=>"7", "date_available(3i)"=>"8", "description"=>"<p>This is a nice product which u can buy in cheap rates</p>", "is_discontinued"=>"0", "size_depth"=>"40", "tag_ids"=>["", "2"], "size_width"=>"5"}, "image"=>[{"image_data_temp"=>"", "image_data"=>#<File:/tmp/RackMultipart6667-0>}, {"image_data_temp"=>""}, {"image_data_temp"=>""}]}
  [4;36;1mPreference Load (3.2ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (2.9ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (2.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.0ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m

**** Deprecation warning: related_product_ids= called from /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/base.rb:2906:in `send'. Use related_product_suggestion_names= instead of related_product_ids= ****
  [4;36;1mProduct Load (0.7ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mItem Load (0.4ms)[0m   [0mSELECT `items`.id FROM `items` WHERE (`items`.`code` = BINARY 'A001') LIMIT 1[0m
  [4;36;1mProduct Create (0.5ms)[0m   [0;1mINSERT INTO `items` (`name`, `price`, `code`, `quantity`, `product_id`, `date_available`, `weight`, `variation_quantity`, `type`, `size_height`, `description`, `is_discontinued`, `size_depth`, `size_width`) VALUES('Amit', 450.0, 'A001', 5, 0, '2011-02-08 00:00:00', 20.0, 0, 'Product', 7.0, '<p>This is a nice product which u can buy in cheap rates</p>', 0, 40.0, 5.0)[0m
  [4;35;1mSQL (2.6ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;35;1mSQL (45.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.8ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;36;1mSQL (41.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (1.6ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;35;1mSQL (45.7ms)[0m   [0mCOMMIT[0m
#<File:/tmp/RackMultipart6667-0>
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mImage Create (0.9ms)[0m   [0mINSERT INTO `user_uploads` (`size`, `created_on`, `content_type`, `thumbnail`, `type`, `filename`, `height`, `parent_id`, `width`) VALUES(24647, '2011-02-08 19:21:19', 'image/jpeg', NULL, 'Image', 'amit.jpg', 800, NULL, 600)[0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT * FROM `user_uploads` WHERE (`user_uploads`.`thumbnail` = 'small' AND `user_uploads`.`parent_id` = 1) AND ( (`user_uploads`.`type` = 'Image' ) ) LIMIT 1[0m
  [4;35;1mImage Create (0.6ms)[0m   [0mINSERT INTO `user_uploads` (`size`, `created_on`, `content_type`, `thumbnail`, `type`, `filename`, `height`, `parent_id`, `width`) VALUES(24647, '2011-02-08 19:21:19', 'image/jpeg', 'small', 'Image', 'amit_small.jpg', 200, 1, 150)[0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT * FROM `user_uploads` WHERE (`user_uploads`.`thumbnail` = 'thumb' AND `user_uploads`.`parent_id` = 1) AND ( (`user_uploads`.`type` = 'Image' ) ) LIMIT 1[0m
  [4;35;1mImage Create (0.6ms)[0m   [0mINSERT INTO `user_uploads` (`size`, `created_on`, `content_type`, `thumbnail`, `type`, `filename`, `height`, `parent_id`, `width`) VALUES(24647, '2011-02-08 19:21:19', 'image/jpeg', 'thumb', 'Image', 'amit_thumb.jpg', 75, 1, 56)[0m
  [4;36;1mSQL (72.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mProductImage Create (0.4ms)[0m   [0;1mINSERT INTO `product_images` (`image_id`, `product_id`, `rank`) VALUES(1, 1, NULL)[0m
  [4;35;1mSQL (59.2ms)[0m   [0mCOMMIT[0m
Redirected to http://localhost:3000/admin/products/edit/1
Completed in 1583ms (DB: 288) | 302 Found [http://localhost/admin/products/save]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-08 19:21:19) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.1ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mImage Load (0.9ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_image_upload (26.6ms)
  [4;36;1mDownload Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_product_upload (53.3ms)
Rendered admin/products/_form (115.1ms)
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (9.7ms)
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (5.3ms)
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (23.0ms)
Rendered admin/products/_crud_right (147.6ms)
Completed in 691ms (View: 323, DB: 10) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:21:21) [GET]
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (5.3ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (1.8ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.1ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 256ms (View: 10, DB: 11) | 200 OK [http://localhost/admin/products/suggestion_js]


Processing ContentNodesController#show_by_name (for 127.0.0.1 at 2011-02-08 19:21:32) [GET]
  Parameters: {"name"=>"home"}
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (2.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mSection Load (0.6ms)[0m   [0;1mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mContentNode Load (0.7ms)[0m   [0mSELECT * FROM `content_nodes` WHERE (name = 'home') LIMIT 1[0m
Rendering template within layouts/main
Rendering content_nodes/show_by_name
Rendered shared/_flash (0.2ms)
Completed in 102ms (View: 15, DB: 5) | 200 OK [http://localhost/]
  [4;36;1mPreference Load (1.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-08 19:21:36) [GET]
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (2.2ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;35;1mProduct Load (0.8ms)[0m   [0mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:53
    vendor/plugins/substruct/app/controllers/store_controller.rb:42:in `index'

Rendered rescues/_trace (110.3ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:21:41) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.8ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.9ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (233.5ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)


Processing Admin::ProductsController#save (for 127.0.0.1 at 2011-02-08 19:22:03) [POST]
  Parameters: {"download"=>[{"download_data_temp"=>""}, {"download_data_temp"=>""}], "commit"=>"Save This Product", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "id"=>"1", "product"=>{"related_product_ids"=>["", "", "", "", ""], "price"=>"450.0", "name"=>"Amit", "quantity"=>"5", "code"=>"A001", "weight"=>"20.0", "date_available(1i)"=>"2011", "date_available(2i)"=>"2", "size_height"=>"7.0", "date_available(3i)"=>"8", "description"=>"<p>This is a nice product which u can buy in cheap rates</p>", "is_discontinued"=>"0", "size_depth"=>"40.0", "tag_ids"=>["", "2"], "size_width"=>"5.0"}, "image"=>[{"image_data_temp"=>""}, {"image_data_temp"=>""}]}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.8ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.8ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;35;1mProduct Load (0.3ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`products_tags`.product_id = 1 ) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;35;1mSQL (61.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mdescribe `products_tags`[0m
  [4;35;1mSQL (0.6ms)[0m   [0mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;36;1mSQL (45.4ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mItem Load (0.9ms)[0m   [0;1mSELECT `items`.id FROM `items` WHERE (`items`.`code` = BINARY 'A001' AND `items`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.4ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;36;1mSQL (48.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (1.7ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;35;1mSQL (47.6ms)[0m   [0mCOMMIT[0m
Redirected to http://localhost:3000/admin/products/edit/1
Completed in 385ms (DB: 218) | 302 Found [http://localhost/admin/products/save/1]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-08 19:22:04) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (2.2ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mImage Load (0.9ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (118.4ms)
Rendered admin/products/_image_upload (141.6ms)
  [4;36;1mDownload Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_product_upload (34.6ms)
Rendered admin/products/_form (211.4ms)
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (11.9ms)
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (5.9ms)
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (25.9ms)
Completed in 479ms (View: 257, DB: 12) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:22:05) [GET]
  [4;36;1mPreference Load (2.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (4.4ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.7ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (6.7ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 489ms (View: 11, DB: 23) | 200 OK [http://localhost/admin/products/suggestion_js]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:22:14) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.8ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (1.1ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.6ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (238.3ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-08 19:22:21) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (2.9ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;35;1mProduct Load (0.8ms)[0m   [0mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (1.4ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:53
    vendor/plugins/substruct/app/controllers/store_controller.rb:42:in `index'

Rendered rescues/_trace (105.4ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)


Processing Admin::ProductsController#list (for 127.0.0.1 at 2011-02-08 19:24:15) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.1ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.9ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/products/list
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (6.4ms)
Rendered admin/products/_tag_list_view_item (7.0ms)
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 2 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (3.3ms)
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_view_item (5.5ms)
Rendered admin/products/_right_side (15.6ms)
Completed in 175ms (View: 54, DB: 8) | 200 OK [http://localhost/admin/products/list/]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-08 19:24:21) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.8ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mImage Load (0.9ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_image_upload (23.1ms)
  [4;36;1mDownload Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_product_upload (149.1ms)
Rendered admin/products/_form (206.8ms)
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (10.1ms)
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (8.9ms)
  [4;35;1mProduct Load (5.0ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (36.8ms)
Completed in 499ms (View: 274, DB: 15) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:24:22) [GET]
  [4;36;1mPreference Load (11.1ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (9.3ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (1.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (5.4ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (1.5ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 529ms (View: 5, DB: 30) | 200 OK [http://localhost/admin/products/suggestion_js]


Processing Admin::OrdersController#index (for 127.0.0.1 at 2011-02-08 19:24:31) [GET]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.2ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mOrder Load (0.6ms)[0m   [0mSELECT * FROM `orders` WHERE (order_status_code_id = 5) ORDER BY created_on DESC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/orders/list
Rendered admin/orders/_search (5.0ms)
Rendered admin/orders/_right_side (6.5ms)
Completed in 185ms (View: 148, DB: 4) | 200 OK [http://localhost/admin/orders]


Processing Admin::ContentNodesController#index (for 127.0.0.1 at 2011-02-08 19:24:36) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSection Load (0.6ms)[0m   [0;1mSELECT * FROM `sections` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mContentNode Load (0.8ms)[0m   [0mSELECT * FROM `content_nodes` WHERE (type = 'Blog') ORDER BY created_on DESC LIMIT 0, 10[0m
Rendering template within layouts/admin
Rendering admin/content_nodes/list
Rendered admin/content_nodes/_subnav (2.2ms)
  [4;36;1mSection Load (0.5ms)[0m   [0;1mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 79336530 ) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
  [4;36;1mSection Load (0.6ms)[0m   [0;1mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 989995836 ) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
  [4;36;1mSection Load (0.4ms)[0m   [0;1mSELECT * FROM `sections` INNER JOIN `content_nodes_sections` ON `sections`.id = `content_nodes_sections`.section_id WHERE (`content_nodes_sections`.content_node_id = 972815062 ) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 135138680) [0m
Rendered admin/content_nodes/_content_right_side (1.9ms)
Completed in 123ms (View: 36, DB: 6) | 200 OK [http://localhost/admin/content_nodes]


Processing Admin::ProductsController#index (for 127.0.0.1 at 2011-02-08 19:24:40) [GET]
  [4;36;1mPreference Load (2.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (5.5ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (4.9ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (0.7ms)[0m   [0mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/products/list
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (6.3ms)
Rendered admin/products/_tag_list_view_item (7.1ms)
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 2 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (3.0ms)
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_view_item (7.6ms)
Rendered admin/products/_right_side (19.7ms)
Completed in 220ms (View: 63, DB: 19) | 200 OK [http://localhost/admin/products]


Processing Admin::ProductsController#list_by_tags (for 127.0.0.1 at 2011-02-08 19:24:44) [GET]
  Parameters: {"key"=>"2"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.9ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.8ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (id='2') LIMIT 1[0m
  [4;35;1mProduct Load (0.8ms)[0m   [0mSELECT * FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 2 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 30[0m
Rendering template within layouts/admin
Rendering admin/products/list
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (4.7ms)
Rendered admin/products/_tag_list_view_item (5.4ms)
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `items` INNER JOIN `products_tags` ON `items`.id = `products_tags`.product_id WHERE (`products_tags`.tag_id = 2 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_tag_text (3.6ms)
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_view_item (5.9ms)
Rendered admin/products/_right_side (14.5ms)
Completed in 180ms (View: 49, DB: 10) | 200 OK [http://localhost/admin/products/list_by_tags?key=2]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-08 19:25:00) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (0.9ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (3.9ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mImage Load (0.9ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_image_upload (25.5ms)
  [4;35;1mDownload Load (1.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_product_upload (152.1ms)
Rendered admin/products/_form (216.3ms)
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (11.0ms)
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (6.5ms)
  [4;36;1mProduct Load (0.8ms)[0m   [0;1mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (28.4ms)
Completed in 555ms (View: 270, DB: 14) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:25:01) [GET]
  [4;35;1mPreference Load (3.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (4.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (2.8ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (1.1ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (0.9ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 248ms (View: 8, DB: 17) | 200 OK [http://localhost/admin/products/suggestion_js]


Processing Admin::ProductsController#save (for 127.0.0.1 at 2011-02-08 19:25:29) [POST]
  Parameters: {"download"=>[{"download_data_temp"=>""}, {"download_data_temp"=>""}], "commit"=>"Save This Product", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "id"=>"1", "product"=>{"related_product_ids"=>["", "", "", "", ""], "price"=>"450.0", "name"=>"Amit", "quantity"=>"5", "code"=>"A001", "weight"=>"20.0", "date_available(1i)"=>"2011", "date_available(2i)"=>"2", "size_height"=>"7.0", "date_available(3i)"=>"8", "description"=>"<p>This is a nice product which u can buy in cheap rates</p>", "is_discontinued"=>"1", "size_depth"=>"40.0", "tag_ids"=>["", "2"], "size_width"=>"5.0"}, "image"=>[{"image_data_temp"=>""}, {"image_data_temp"=>""}]}
  [4;36;1mPreference Load (5.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.9ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;36;1mProduct Load (0.3ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`products_tags`.product_id = 1 ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.4ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;36;1mSQL (75.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.9ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;35;1mSQL (39.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mItem Load (0.5ms)[0m   [0mSELECT `items`.id FROM `items` WHERE (`items`.`code` = BINARY 'A001' AND `items`.id <> 1) LIMIT 1[0m
  [4;36;1mProduct Update (0.5ms)[0m   [0;1mUPDATE `items` SET `is_discontinued` = 1 WHERE `id` = 1[0m
  [4;35;1mSQL (38.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.8ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;36;1mSQL (40.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (1.0ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.8ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;35;1mSQL (48.0ms)[0m   [0mCOMMIT[0m
Redirected to http://localhost:3000/admin/products/edit/1
Completed in 420ms (DB: 264) | 302 Found [http://localhost/admin/products/save/1]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-08 19:25:30) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (1.1ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.9ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (1.3ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mImage Load (0.9ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_image_upload (22.5ms)
  [4;36;1mDownload Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_product_upload (145.5ms)
Rendered admin/products/_form (201.0ms)
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (13.5ms)
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (5.7ms)
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.4ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (27.4ms)
Completed in 519ms (View: 250, DB: 13) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-08 19:25:30) [GET]
  [4;36;1mPreference Load (1.1ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (5.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (4.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (3.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (5.3ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.8ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (5.9ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 476ms (View: 7, DB: 27) | 200 OK [http://localhost/admin/products/suggestion_js]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-08 19:25:35) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.2ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;36;1mProduct Load (0.9ms)[0m   [0;1mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:53
    vendor/plugins/substruct/app/controllers/store_controller.rb:42:in `index'

Rendered rescues/_trace (103.1ms)
Rendered rescues/_request_and_response (137.4ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (1.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:25:41) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.2ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (2.6ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.6ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (97.2ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (2.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:27:43) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.7ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.7ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.8ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.7ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (101.2ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:27:46) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.6ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (2.2ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (226.9ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:27:58) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.8ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.8ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (230.8ms)
Rendered rescues/_request_and_response (2.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:28:30) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (2.3ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.7ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (2.7ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25: <!--    <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: -->

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (228.7ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (2.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-08 19:28:45) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.2ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.6ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.9ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (277.7ms)
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered shared/_flash (1.2ms)
Completed in 426ms (View: 331, DB: 14) | 200 OK [http://localhost/store/s/T-Shirt]
/!\ FAILSAFE /!\  Wed Feb 09 11:19:24 +0530 2011
  Status: 500 Internal Server Error
  Can't connect to local MySQL server through socket '/opt/lampp/var/mysql/mysql.sock' (2)
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/mysql2/client.rb:37:in `connect'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/mysql2/client.rb:37:in `initialize'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:14:in `new'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:14:in `mysql2_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:223:in `send'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:223:in `new_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:245:in `checkout_new_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:188:in `checkout'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:184:in `loop'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:184:in `checkout'
    /usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:183:in `checkout'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:98:in `connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:326:in `retrieve_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_specification.rb:123:in `retrieve_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_specification.rb:115:in `connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
    /usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    /usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
    script/server:3
/!\ FAILSAFE /!\  Wed Feb 09 11:19:24 +0530 2011
  Status: 500 Internal Server Error
  Can't connect to local MySQL server through socket '/opt/lampp/var/mysql/mysql.sock' (2)
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/mysql2/client.rb:37:in `connect'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/mysql2/client.rb:37:in `initialize'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:14:in `new'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:14:in `mysql2_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:223:in `send'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:223:in `new_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:245:in `checkout_new_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:188:in `checkout'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:184:in `loop'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:184:in `checkout'
    /usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:183:in `checkout'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:98:in `connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:326:in `retrieve_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_specification.rb:123:in `retrieve_connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_specification.rb:115:in `connection'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
    /home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
    /var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
    /var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
    /home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
    /usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    /usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
    script/server:3
  [4;36;1mPreference Load (2.1ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (1.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-09 11:20:37) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (17.3ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.7ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (2.4ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (13.5ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (1.1ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;35;1mSQL (19.1ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;36;1mImage Load (22.0ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (9.7ms)
Rendered admin/products/_image_upload (105.6ms)
  [4;36;1mDownload Load (2.2ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.3ms)
Rendered admin/products/_product_upload (110.4ms)
Rendered admin/products/_form (382.2ms)
  [4;35;1mTag Load (1.1ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (145.8ms)
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (7.0ms)
  [4;35;1mProduct Load (1.5ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (18.7ms)
Rendered admin/products/_relative (0.7ms)
Rendered admin/products/_relative (0.5ms)
Rendered admin/products/_relative (0.6ms)
Rendered admin/products/_relative (0.5ms)
Rendered admin/products/_crud_right (203.6ms)
Completed in 1361ms (View: 705, DB: 85) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-09 11:20:39) [GET]
  [4;36;1mPreference Load (4.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (1.1ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (4.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (3.2ms)[0m   [0;1mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 438ms (View: 238, DB: 16) | 200 OK [http://localhost/admin/products/suggestion_js]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:20:58) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (30.1ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (18.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.7ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (2.3ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.9ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (1.2ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25: <!--    <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: -->

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (248.0ms)
Rendered rescues/_request_and_response (2.3ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:48:09) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.7ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (2.2ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (1.1ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.8ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (100.3ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:48:51) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (1.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.7ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (2.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.7ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (2.3ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (101.7ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:49:18) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.8ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.5ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.8ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.7ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (1.2ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (243.3ms)
Rendered rescues/_request_and_response (2.8ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:49:22) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (1.2ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.7ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (1.0ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (2.2ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (99.8ms)
Rendered rescues/_request_and_response (32.7ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:49:45) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (1.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.9ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (1.0ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (99.4ms)
Rendered rescues/_request_and_response (0.8ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:52:25) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (2.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.7ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (3.9ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (1.4ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28:   </div>

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (141.2ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:53:31) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (2.0ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (1.1ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <!--<% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: 

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (244.7ms)
Rendered rescues/_request_and_response (2.4ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:53:33) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.7ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (1.9ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <!--<% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: 

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (97.7ms)
Rendered rescues/_request_and_response (32.7ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:56:22) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.8ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.7ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <!--<% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: -->

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (249.4ms)
Rendered rescues/_request_and_response (2.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (1.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:56:25) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.9ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;36;1mTag Load (0.3ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;36;1mTag Load (0.9ms)[0m   [0;1mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;35;1mProduct Load (2.0ms)[0m   [0mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;36;1mTag Load (0.9ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC, -variation_rank DESC[0m

ActionView::TemplateError (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY price ASC, -variation_rank DESC) on line #25 of vendor/plugins/substruct/app/views/store/_product.rhtml:
22:     <div class="product_title">
23:       <%= link_to(product.name, :controller=>'store', :action=>'show', :id => product.code) %>
24:     </div>
25:     <!--<% if product.display_price? %>
26:       <span class="money"><%= sub_number_to_currency(product.display_price) %></span>
27:     <% end %>
28: -->

    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
    /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
    vendor/plugins/substruct/app/models/product.rb:108:in `display_price'
    vendor/plugins/substruct/app/models/product.rb:123:in `display_price?'
    vendor/plugins/substruct/app/views/store/_product.rhtml:25:in `_run_rhtml_vendor47plugins47substruct47app47views47store47_product46rhtml_locals_object_product_product_counter'
    vendor/plugins/substruct/app/views/store/index.rhtml:33:in `_run_rhtml_vendor47plugins47substruct47app47views47store47index46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:122:in `show_by_tags'

Rendered rescues/_trace (96.7ms)
Rendered rescues/_request_and_response (31.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:57:25) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (2.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (0.8ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (2.5ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (1.4ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (156.1ms)
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered shared/_flash (1.7ms)
Completed in 472ms (View: 236, DB: 15) | 200 OK [http://localhost/store/s/T-Shirt]
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_by_tags (for 127.0.0.1 at 2011-02-09 11:58:05) [GET]
  Parameters: {"tags"=>["T-Shirt"]}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`name` = 'T-Shirt') LIMIT 1[0m
  [4;35;1mTag Load (0.3ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) ORDER BY parent_id ASC[0m
  [4;36;1mItem Load (1.2ms)[0m   [0;1mSELECT items.id FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) GROUP BY items.id HAVING COUNT(*)=1;[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT DISTINCT t.* FROM products_tags pt, tags t WHERE pt.product_id IN(1)AND t.id = pt.tag_id AND t.id NOT IN (2);[0m
  [4;36;1mProduct Load (1.6ms)[0m   [0;1mSELECT * FROM items JOIN products_tags on items.id = products_tags.product_id WHERE products_tags.tag_id IN (2) AND 
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 GROUP BY items.id HAVING COUNT(*)=1 ORDER BY items.date_available DESC;[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (269.3ms)
  [4;36;1mTag Load (0.5ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered shared/_flash (0.2ms)
Completed in 384ms (View: 284, DB: 12) | 200 OK [http://localhost/store/s/T-Shirt]
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 11:58:11) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY -variation_rank DESC, -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY -variation_rank DESC, -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (69.4ms)
Rendered rescues/_request_and_response (2.4ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 11:58:34) [GET]
  Parameters: {"id"=>"A001"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mProduct Load (0.7ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mImage Load (0.8ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (202.5ms)
Rendered rescues/_request_and_response (1.0ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (3.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 11:59:00) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.6ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (4.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (66.4ms)
Rendered rescues/_request_and_response (4.1ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:01:53) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.2ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (1.0ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC, -variation_rank DESC' at line 1: SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY DESC, -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC, -variation_rank DESC' at line 1: SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY DESC, -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (68.5ms)
Rendered rescues/_request_and_response (2.4ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:01:56) [GET]
  Parameters: {"id"=>"A001"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mImage Load (1.0ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.0ms)[0m   [0mMysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC, -variation_rank DESC' at line 1: SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY DESC, -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC, -variation_rank DESC' at line 1: SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY DESC, -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (200.6ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:02:43) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.7ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (0.7ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (0.8ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.0ms)[0m   [0;1mMysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY -variation_rank DESC[0m

ActiveRecord::StatementInvalid (Mysql2::Error: Unknown column 'variation_rank' in 'order clause': SELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) )  ORDER BY -variation_rank DESC):
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:314:in `execute'
  /var/lib/gems/1.8/gems/mysql2-0.2.6/lib/active_record/connection_adapters/mysql2_adapter.rb:635:in `select'
  vendor/plugins/substruct/app/controllers/store_controller.rb:150:in `show'

Rendered rescues/_trace (69.2ms)
Rendered rescues/_request_and_response (2.8ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:04:06) [GET]
  Parameters: {"id"=>"A001"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m

SyntaxError (/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:19: syntax error, unexpected tSTRING_BEG, expecting kEND
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:23: syntax error, unexpected tCONSTANT, expecting kEND
    :class_name => 'Product',
                           ^
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:24: syntax error, unexpected tIDENTIFIER, expecting kEND
    :join_table => 'related_products',
                                    ^
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:25: syntax error, unexpected tIDENTIFIER, expecting kEND
    :association_foreign_key => 'related_id',
                                           ^
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:26: syntax error, unexpected tIDENTIFIER, expecting kEND
    :foreign_key => 'product_id',
                               ^
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:62: syntax error, unexpected tCONSTANT, expecting kEND
		sql << ") AND items.type = 'Product' "
		                                   ^
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/models/product.rb:76: syntax error, unexpected tIDENTIFIER, expecting kEND
	# and using GROUP BY & COUNT with the number of tag id's given
	                                                        ^):
  vendor/plugins/substruct/app/controllers/store_controller.rb:142:in `show'

Rendered rescues/_trace (64.6ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:04:26) [GET]
  Parameters: {"id"=>"A001"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.5ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mImage Load (0.7ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendering template within layouts/main
Rendering store/show
  [4;36;1mProduct Load (0.7ms)[0m   [0;1mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;35;1mVariation Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC[0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendered shared/_flash (1.4ms)
Completed in 416ms (View: 199, DB: 9) | 200 OK [http://localhost/store/show/A001]


Processing CustomersController#add_to_wishlist (for 127.0.0.1 at 2011-02-09 12:04:34) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
Redirected to http://localhost:3000/customers/login
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 31ms (DB: 2) | 302 Found [http://localhost/customers/add_to_wishlist/1]


Processing CustomersController#login (for 127.0.0.1 at 2011-02-09 12:04:35) [GET]
  [4;35;1mPreference Load (1.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
Rendering template within layouts/main
Rendering customers/login
Rendered shared/_flash (0.2ms)
Completed in 223ms (View: 188, DB: 3) | 200 OK [http://localhost/customers/login]


Processing CustomersController#new (for 127.0.0.1 at 2011-02-09 12:04:55) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.3ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
Rendering template within layouts/main
Rendering customers/new
Rendered customers/_details_form (47.4ms)
Rendered shared/_flash (0.2ms)
Completed in 119ms (View: 81, DB: 2) | 200 OK [http://localhost/customers/new]


Processing CustomersController#new (for 127.0.0.1 at 2011-02-09 12:05:09) [POST]
  Parameters: {"commit"=>"Create new account", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "customer"=>{"email_address"=>"amitbaraik@gmail.com", "password"=>"lovely"}}
  [4;35;1mPreference Load (2.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.3ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` IS NULL) LIMIT 1[0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mPreference Load (2.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;36;1mOrderUser Create (4.5ms)[0m   [0;1mINSERT INTO `order_users` (`created_on`, `last_name`, `email_address`, `password`, `first_name`) VALUES('2011-02-09 12:05:09', '', 'amitbaraik@gmail.com', 'lovely', '')[0m
  [4;35;1mSQL (67.4ms)[0m   [0mCOMMIT[0m
Redirected to http://localhost:3000/customers/add_to_wishlist/1
Completed in 171ms (DB: 82) | 302 Found [http://localhost/customers/new]


Processing CustomersController#add_to_wishlist (for 127.0.0.1 at 2011-02-09 12:05:10) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mItem Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = '1') LIMIT 1[0m
  [4;36;1mItem Load (0.7ms)[0m   [0;1mSELECT `items`.id FROM `items` INNER JOIN `wishlist_items` ON `items`.id = `wishlist_items`.item_id WHERE (`items`.`id` = 1) AND ((`wishlist_items`.order_user_id = 1)) ORDER BY wishlist_items.created_on DESC LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mWishlistItem Create (0.4ms)[0m   [0;1mINSERT INTO `wishlist_items` (`created_on`, `item_id`, `order_user_id`) VALUES('2011-02-09 12:05:10', 1, 1)[0m
  [4;35;1mSQL (82.7ms)[0m   [0mCOMMIT[0m
Redirected to http://localhost:3000/customers/wishlist
Completed in 184ms (DB: 87) | 302 Found [http://localhost/customers/add_to_wishlist/1]


Processing CustomersController#wishlist (for 127.0.0.1 at 2011-02-09 12:05:10) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mItem Load (0.9ms)[0m   [0mSELECT `items`.* FROM `items` INNER JOIN `wishlist_items` ON `items`.id = `wishlist_items`.item_id WHERE ((`wishlist_items`.order_user_id = 1)) ORDER BY wishlist_items.created_on DESC LIMIT 0, 20[0m
Rendering template within layouts/main
Rendering customers/wishlist
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (141.7ms)
Rendered customers/_sidebar (3.8ms)
Rendered shared/_flash (0.2ms)
Completed in 474ms (View: 198, DB: 6) | 200 OK [http://localhost/customers/wishlist]


Processing CustomersController#orders (for 127.0.0.1 at 2011-02-09 12:05:23) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.8ms)[0m   [0;1mSELECT * FROM `orders` WHERE (`orders`.order_user_id = 1) ORDER BY created_on DESC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering customers/orders
Rendered customers/_sidebar (2.5ms)
Rendered shared/_flash (0.2ms)
Completed in 228ms (View: 31, DB: 3) | 200 OK [http://localhost/customers/orders]


Processing CustomersController#orders (for 127.0.0.1 at 2011-02-09 12:05:30) [GET]
  [4;35;1mPreference Load (1.1ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.8ms)[0m   [0;1mSELECT * FROM `orders` WHERE (`orders`.order_user_id = 1) ORDER BY created_on DESC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering customers/orders
Rendered customers/_sidebar (1.9ms)
Rendered shared/_flash (0.2ms)
Completed in 80ms (View: 20, DB: 4) | 200 OK [http://localhost/customers/orders]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-09 12:05:34) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (1.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.6ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;36;1mProduct Load (0.8ms)[0m   [0;1mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (134.3ms)
Rendered shared/_flash (0.2ms)
Completed in 406ms (View: 309, DB: 9) | 200 OK [http://localhost/store]
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:05:37) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (1.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.7ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendering template within layouts/main
Rendering store/show
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;36;1mVariation Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendered shared/_flash (0.2ms)
Completed in 415ms (View: 41, DB: 9) | 200 OK [http://localhost/store/show/A001]


Processing CustomersController#add_to_wishlist (for 127.0.0.1 at 2011-02-09 12:05:53) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mItem Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = '1') LIMIT 1[0m
  [4;35;1mItem Load (0.8ms)[0m   [0mSELECT `items`.id FROM `items` INNER JOIN `wishlist_items` ON `items`.id = `wishlist_items`.item_id WHERE (`items`.`id` = 1) AND ((`wishlist_items`.order_user_id = 1)) ORDER BY wishlist_items.created_on DESC LIMIT 1[0m
Redirected to http://localhost:3000/customers/wishlist
Completed in 82ms (DB: 4) | 302 Found [http://localhost/customers/add_to_wishlist/1]


Processing CustomersController#wishlist (for 127.0.0.1 at 2011-02-09 12:05:53) [GET]
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.7ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mItem Load (0.9ms)[0m   [0mSELECT `items`.* FROM `items` INNER JOIN `wishlist_items` ON `items`.id = `wishlist_items`.item_id WHERE ((`wishlist_items`.order_user_id = 1)) ORDER BY wishlist_items.created_on DESC LIMIT 0, 20[0m
Rendering template within layouts/main
Rendering customers/wishlist
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;36;1mImage Load (0.6ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (133.0ms)
Rendered customers/_sidebar (1.7ms)
Rendered shared/_flash (0.2ms)
Completed in 243ms (View: 160, DB: 5) | 200 OK [http://localhost/customers/wishlist]


Processing CustomersController#orders (for 127.0.0.1 at 2011-02-09 12:05:57) [GET]
  [4;35;1mPreference Load (1.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (1.1ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.8ms)[0m   [0;1mSELECT * FROM `orders` WHERE (`orders`.order_user_id = 1) ORDER BY created_on DESC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering customers/orders
Rendered customers/_sidebar (1.9ms)
Rendered shared/_flash (0.5ms)
Completed in 89ms (View: 19, DB: 5) | 200 OK [http://localhost/customers/orders]


Processing CustomersController#wishlist (for 127.0.0.1 at 2011-02-09 12:06:00) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (3.1ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mItem Load (0.9ms)[0m   [0;1mSELECT `items`.* FROM `items` INNER JOIN `wishlist_items` ON `items`.id = `wishlist_items`.item_id WHERE ((`wishlist_items`.order_user_id = 1)) ORDER BY wishlist_items.created_on DESC LIMIT 0, 20[0m
Rendering template within layouts/main
Rendering customers/wishlist
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (4.2ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (380.1ms)
Rendered customers/_sidebar (1.8ms)
Rendered shared/_flash (0.2ms)
Completed in 477ms (View: 399, DB: 11) | 200 OK [http://localhost/customers/wishlist]
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:06:05) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.9ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.3ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;35;1mOrderStatusCode Load (0.5ms)[0m   [0mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mProduct Load (0.7ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mImage Load (1.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mVariation Load (0.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendering template within layouts/main
Rendering store/show
  [4;35;1mProduct Load (0.7ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;36;1mVariation Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC[0m
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendered shared/_flash (0.2ms)
Completed in 418ms (View: 40, DB: 9) | 200 OK [http://localhost/store/show/A001]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#add_to_cart_ajax (for 127.0.0.1 at 2011-02-09 12:06:09) [POST]
  Parameters: {"quantity"=>"1", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "id"=>"1"}
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.3ms)[0m   [0mSELECT * FROM `orders` WHERE (id = NULL) LIMIT 1[0m
  [4;36;1mOrderStatusCode Load (0.5ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'CART') LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mItem Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = '1') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mOrder Load (0.8ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 0) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT * FROM `orders` WHERE (order_number = 561335069) LIMIT 1[0m
  [4;35;1mOrder Create (0.5ms)[0m   [0mINSERT INTO `orders` (`tax`, `shipping_address_id`, `billing_address_id`, `created_on`, `notes`, `promotion_id`, `shipped_on`, `order_shipping_type_id`, `affiliate_id`, `order_number`, `referer`, `auth_transaction_id`, `order_account_id`, `affiliate_payment_id`, `product_cost`, `order_user_id`, `order_status_code_id`, `shipping_cost`) VALUES(0.0, 0, 0, '2011-02-09 12:06:09', NULL, 0, NULL, 1, 0, 561335069, NULL, NULL, 0, 0, 0.0, NULL, 1, 0.0)[0m
  [4;36;1mSQL (89.3ms)[0m   [0;1mCOMMIT[0m
QUANTITY: 1
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
PRODUCT QUANTITY: 5
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
Quantity too much? false
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mOrderLineItem Load (0.4ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1 AND (item_id = 1)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mOrderLineItem Create (0.4ms)[0m   [0mINSERT INTO `order_line_items` (`name`, `quantity`, `order_id`, `unit_price`, `item_id`) VALUES('Amit', 1, 1, 450.0, 1)[0m
  [4;36;1mSQL (58.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
Product added...success
CALCULATING SHIPPING TOTAL
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_cart (132.3ms)
Completed in 448ms (View: 143, DB: 159) | 200 OK [http://localhost/store/add_to_cart_ajax/1]
  [4;36;1mPreference Load (3.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show_cart (for 127.0.0.1 at 2011-02-09 12:06:10) [GET]
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.7ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendering template within layouts/modal
Rendering store/show_cart
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrderLineItem Load (0.6ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mItem Load (4.6ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;35;1mImage Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Completed in 528ms (View: 474, DB: 19) | 200 OK [http://localhost/store/show_cart]
  [4;36;1mPreference Load (1.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:06:15) [GET]
  [4;35;1mPreference Load (0.4ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m


NEW ORDER INIT

  [4;35;1mOrder Load (0.6ms)[0m   [0mSELECT * FROM `orders` WHERE (`orders`.order_user_id = 1) ORDER BY created_on DESC LIMIT 1[0m
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (80.1ms)
  [4;36;1mCountry Load (0.4ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 0) [0m
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>nil, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:06:16) [GET]
  Parameters: {"selected"=>nil, "select_name"=>"billing_address", "id"=>nil}
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mCountry Load (4.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 33ms (View: 15, DB: 5) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (67.9ms)
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 0) [0m
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>nil, :select_name=>"shipping_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:06:16) [GET]
  Parameters: {"selected"=>nil, "select_name"=>"shipping_address", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 15ms (View: 5, DB: 0) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (23.4ms)
Rendered admin/orders/_account (6.1ms)
  [4;36;1mPromotion Load (0.8ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (NOW() BETWEEN start AND end) LIMIT 1[0m
  [4;35;1mOrderLineItem Load (0.6ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mItem Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (56.6ms)
Rendered store/_clear_cart (1.0ms)
Rendered shared/_flash (0.2ms)
Completed in 651ms (View: 417, DB: 9) | 200 OK [http://localhost/store/checkout]


Processing Admin::ProductsController#save (for 127.0.0.1 at 2011-02-09 12:10:24) [POST]
  Parameters: {"download"=>[{"download_data_temp"=>""}, {"download_data_temp"=>""}], "commit"=>"Save This Product", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "id"=>"1", "product"=>{"related_product_ids"=>["", "", "", "", ""], "price"=>"450.0", "name"=>"Amit", "quantity"=>"5", "code"=>"A001", "weight"=>"20.0", "date_available(1i)"=>"2011", "date_available(2i)"=>"2", "size_height"=>"7.0", "date_available(3i)"=>"8", "description"=>"<p>This is a nice product which u can buy in cheap rates</p>", "is_discontinued"=>"1", "size_depth"=>"40.0", "tag_ids"=>["", "1", "2"], "size_width"=>"5.0"}, "image"=>[{"image_data_temp"=>""}, {"image_data_temp"=>""}]}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mRole Load (0.9ms)[0m   [0;1mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;35;1mRight Load (0.9ms)[0m   [0mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mProduct Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m

**** Deprecation warning: related_product_ids= called from /home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/base.rb:2906:in `send'. Use related_product_suggestion_names= instead of related_product_ids= ****
  [4;35;1mProduct Load (0.7ms)[0m   [0mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;36;1mProduct Load (0.3ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`code` IS NULL) AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT * FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`products_tags`.product_id = 1 ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.5ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (2)[0m
  [4;36;1mSQL (103.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (1.7ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (1, 1)[0m
  [4;35;1mSQL (55.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mdescribe `products_tags`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;36;1mSQL (47.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mItem Load (0.6ms)[0m   [0;1mSELECT `items`.id FROM `items` WHERE (`items`.`code` = BINARY 'A001' AND `items`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.5ms)[0m   [0mDELETE FROM `products_tags` WHERE product_id = 1 AND tag_id IN (1,2)[0m
  [4;36;1mSQL (47.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mTag Load (0.8ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.8ms)[0m   [0mdescribe `products_tags`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (1, 1)[0m
  [4;35;1mSQL (37.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mTag Load (0.8ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mdescribe `products_tags`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mINSERT INTO `products_tags` (`tag_id`, `product_id`) VALUES (2, 1)[0m
  [4;36;1mSQL (45.0ms)[0m   [0;1mCOMMIT[0m
Redirected to http://localhost:3000/admin/products/edit/1
Completed in 538ms (DB: 355) | 302 Found [http://localhost/admin/products/save/1]


Processing Admin::ProductsController#edit (for 127.0.0.1 at 2011-02-09 12:10:25) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (1.0ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (1.0ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendering template within layouts/admin
Rendering admin/products/edit
  [4;36;1mSQL (0.9ms)[0m   [0;1mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
  [4;35;1mImage Load (1.0ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered shared/_multiple_upload (2.6ms)
Rendered admin/products/_image_upload (173.3ms)
  [4;35;1mDownload Load (0.7ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_downloads` ON `user_uploads`.id = `product_downloads`.download_id WHERE ((`product_downloads`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Download' ) ) ORDER BY -product_downloads.rank DESC[0m
Rendered shared/_multiple_upload (0.2ms)
Rendered admin/products/_product_upload (35.4ms)
Rendered admin/products/_form (265.3ms)
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 1) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mTag Load (0.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (`tags`.parent_id = 1) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (11.8ms)
  [4;35;1mTag Load (0.5ms)[0m   [0mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `tags`.id FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`id` = 2) AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (`tags`.parent_id = 2) ORDER BY -rank DESC[0m
Rendered admin/products/_tag_list_form_row (5.7ms)
  [4;36;1mProduct Load (0.6ms)[0m   [0;1mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
Rendered admin/products/_relative (1.3ms)
Rendered admin/products/_relative (0.6ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_relative (0.3ms)
Rendered admin/products/_crud_right (47.1ms)
Completed in 600ms (View: 370, DB: 11) | 200 OK [http://localhost/admin/products/edit/1]


Processing Admin::ProductsController#suggestion_js (for 127.0.0.1 at 2011-02-09 12:10:26) [GET]
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (6.4ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.7ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mRole Load (1.0ms)[0m   [0mSELECT * FROM `roles` INNER JOIN `roles_users` ON `roles`.id = `roles_users`.role_id WHERE (`roles_users`.user_id = 1 ) ORDER BY name ASC[0m
  [4;36;1mRight Load (5.4ms)[0m   [0;1mSELECT * FROM `rights` INNER JOIN `rights_roles` ON `rights`.id = `rights_roles`.right_id WHERE (`rights_roles`.role_id = 518252170 ) ORDER BY name ASC[0m
[AUTH] affiliates - *
[AUTH] content_nodes - *
[AUTH] customers - *
[AUTH] files - *
[AUTH] orders - *
[AUTH] preferences - *
[AUTH] products - *
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mProduct Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE ( (`items`.`type` = 'Product' ) ) [0m
Rendering admin/products/suggestion_js
Completed in 255ms (View: 25, DB: 24) | 200 OK [http://localhost/admin/products/suggestion_js]
  [4;36;1mPreference Load (1.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:10:50) [POST]
  Parameters: {"commit"=>"Submit Order Information", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "shipping_address"=>{"city"=>"", "address"=>"", "zip"=>"", "country_id"=>"880262049", "last_name"=>"", "telephone"=>"", "state"=>"", "first_name"=>""}, "billing_address"=>{"city"=>"Pune", "address"=>"Zi-AP", "zip"=>"411048", "country_id"=>"822512167", "last_name"=>"Kumar", "telephone"=>"+919890654102", "state"=>"Maharshtra", "first_name"=>"Amit"}, "order_user"=>{"email_address"=>"amitbaraik@gmail.com"}, "order_account"=>{"expiration_year"=>"2011", "expiration_month"=>"1", "cc_number"=>"4444444444444444"}, "use_separate_shipping_address"=>"true"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.5ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m



CREATING NEW ORDER FROM POST


true



  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`email_address` = 'amitbaraik@gmail.com') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mOrder Load (0.5ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrderLineItem Load (0.6ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.6ms)[0m   [0mUPDATE `orders` SET `product_cost` = 450.0, `order_user_id` = 1 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mOrderAddress Create (0.4ms)[0m   [0mINSERT INTO `order_addresses` (`address`, `city`, `zip`, `country_id`, `last_name`, `telephone`, `order_user_id`, `first_name`, `state`) VALUES('Zi-AP', 'Pune', '411048', 822512167, 'Kumar', '+919890654102', 1, 'Amit', 'Maharshtra')[0m
  [4;36;1mOrder Load (0.5ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.4ms)[0m   [0mUPDATE `orders` SET `shipping_address_id` = 1, `billing_address_id` = 1 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.4ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;35;1mSQL (41.0ms)[0m   [0mROLLBACK[0m


Something went bad when trying to checkout...
Validation failed: {{errors}}

/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/validations.rb:1102:in `save_without_dirty!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/dirty.rb:87:in `save_without_transactions!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:108:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:98:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:91:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:441:in `do_checkout'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/flash.rb:151:in `perform_action'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:438:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/head.rb:9:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/methodoverride.rb:24:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:128:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (1.1ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:10:50) [POST]
  Parameters: {"selected"=>822512167, "select_name"=>"billing_address", "id"=>nil}

ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):
  vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:55:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47orders47_address46rhtml_locals_address_address_type_object'
  vendor/plugins/substruct/app/views/store/checkout.rhtml:61:in `_run_rhtml_vendor47plugins47substruct47app47views47store47checkout46rhtml'
  vendor/plugins/substruct/app/controllers/store_controller.rb:486:in `do_checkout'
  vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'

Rendered rescues/_trace (260.5ms)
Rendered rescues/_request_and_response (0.8ms)
Rendering rescues/layout (unprocessable_entity)


End of component rendering
Rendered admin/orders/_address (291.4ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>880262049, :select_name=>"shipping_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:10:50) [POST]
  Parameters: {"selected"=>880262049, "select_name"=>"shipping_address", "id"=>nil}

ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):
  vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:55:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47orders47_address46rhtml_locals_address_address_type_object'
  vendor/plugins/substruct/app/views/store/checkout.rhtml:73:in `_run_rhtml_vendor47plugins47substruct47app47views47store47checkout46rhtml'
  vendor/plugins/substruct/app/controllers/store_controller.rb:486:in `do_checkout'
  vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'

Rendered rescues/_trace (113.2ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (unprocessable_entity)


End of component rendering
Rendered admin/orders/_address (157.4ms)
Rendered admin/orders/_account (3.5ms)
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (NOW() BETWEEN start AND end) LIMIT 1[0m
  [4;35;1mItem Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (47.3ms)
Rendered store/_clear_cart (0.2ms)
Rendered shared/_flash (25.4ms)
Completed in 789ms (View: 561, DB: 56) | 200 OK [http://localhost/store/checkout]
  [4;35;1mPreference Load (5.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:11:23) [POST]
  Parameters: {"commit"=>"Submit Order Information", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "shipping_address"=>{"city"=>"", "address"=>"", "zip"=>"", "country_id"=>"880262049", "last_name"=>"", "telephone"=>"", "state"=>"", "first_name"=>""}, "billing_address"=>{"city"=>"Pune", "address"=>"Zi-AP", "zip"=>"411048", "country_id"=>"822512167", "last_name"=>"Kumar", "telephone"=>"+919890654102", "state"=>"Maharshtra", "first_name"=>"Amit"}, "order_user"=>{"email_address"=>"amitbaraik@gmail.com"}, "order_account"=>{"expiration_year"=>"2011", "expiration_month"=>"1", "cc_number"=>"4444444444444444"}, "use_separate_shipping_address"=>"true"}
  [4;36;1mPreference Load (4.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (1.9ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (2.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (1.6ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m



CREATING NEW ORDER FROM POST


true



  [4;36;1mOrderUser Load (0.9ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`email_address` = 'amitbaraik@gmail.com') LIMIT 1[0m
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;36;1mCountry Load (0.4ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrderLineItem Load (0.5ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrder Update (0.7ms)[0m   [0;1mUPDATE `orders` SET `product_cost` = 450.0, `order_user_id` = 1 WHERE `id` = 1[0m
  [4;35;1mCountry Load (0.9ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;36;1mOrderAddress Create (0.4ms)[0m   [0;1mINSERT INTO `order_addresses` (`address`, `city`, `zip`, `country_id`, `last_name`, `telephone`, `order_user_id`, `first_name`, `state`) VALUES('Zi-AP', 'Pune', '411048', 822512167, 'Kumar', '+919890654102', 1, 'Amit', 'Maharshtra')[0m
  [4;35;1mOrder Load (0.5ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrder Update (0.7ms)[0m   [0;1mUPDATE `orders` SET `shipping_address_id` = 2, `billing_address_id` = 2 WHERE `id` = 1[0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;36;1mSQL (113.0ms)[0m   [0;1mROLLBACK[0m


Something went bad when trying to checkout...
Validation failed: {{errors}}

/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/validations.rb:1102:in `save_without_dirty!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/dirty.rb:87:in `save_without_transactions!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:108:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:98:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:91:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:441:in `do_checkout'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/flash.rb:151:in `perform_action'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:438:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/head.rb:9:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/methodoverride.rb:24:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:128:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (1.1ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:11:23) [POST]
  Parameters: {"selected"=>822512167, "select_name"=>"billing_address", "id"=>nil}

ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):
  vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:55:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47orders47_address46rhtml_locals_address_address_type_object'
  vendor/plugins/substruct/app/views/store/checkout.rhtml:61:in `_run_rhtml_vendor47plugins47substruct47app47views47store47checkout46rhtml'
  vendor/plugins/substruct/app/controllers/store_controller.rb:486:in `do_checkout'
  vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'

Rendered rescues/_trace (114.4ms)
Rendered rescues/_request_and_response (2.5ms)
Rendering rescues/layout (unprocessable_entity)


End of component rendering
Rendered admin/orders/_address (267.4ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>880262049, :select_name=>"shipping_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:11:23) [POST]
  Parameters: {"selected"=>880262049, "select_name"=>"shipping_address", "id"=>nil}

ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken):
  vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:55:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47orders47_address46rhtml_locals_address_address_type_object'
  vendor/plugins/substruct/app/views/store/checkout.rhtml:73:in `_run_rhtml_vendor47plugins47substruct47app47views47store47checkout46rhtml'
  vendor/plugins/substruct/app/controllers/store_controller.rb:486:in `do_checkout'
  vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'

Rendered rescues/_trace (271.9ms)
Rendered rescues/_request_and_response (1.0ms)
Rendering rescues/layout (unprocessable_entity)


End of component rendering
Rendered admin/orders/_address (312.7ms)
Rendered admin/orders/_account (3.3ms)
  [4;35;1mPromotion Load (1.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (NOW() BETWEEN start AND end) LIMIT 1[0m
  [4;36;1mItem Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (52.2ms)
Rendered store/_clear_cart (0.2ms)
Rendered shared/_flash (0.8ms)
Completed in 979ms (View: 665, DB: 146) | 200 OK [http://localhost/store/checkout]
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:16:06) [POST]
  Parameters: {"commit"=>"Submit Order Information", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "shipping_address"=>{"city"=>"", "address"=>"", "zip"=>"", "country_id"=>"880262049", "last_name"=>"", "telephone"=>"", "state"=>"", "first_name"=>""}, "billing_address"=>{"city"=>"Pune", "address"=>"Zi-AP", "zip"=>"411048", "country_id"=>"822512167", "last_name"=>"Kumar", "telephone"=>"+919890654102", "state"=>"Maharshtra", "first_name"=>"Amit"}, "order_user"=>{"email_address"=>"amitbaraik@gmail.com"}, "order_account"=>{"expiration_year"=>"2011", "expiration_month"=>"1", "cc_number"=>"4444444444444444"}, "use_separate_shipping_address"=>"true"}
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m



CREATING NEW ORDER FROM POST


true



  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`email_address` = 'amitbaraik@gmail.com') LIMIT 1[0m
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mOrder Load (0.6ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCountry Load (0.4ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrderLineItem Load (0.5ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.6ms)[0m   [0mUPDATE `orders` SET `product_cost` = 450.0, `order_user_id` = 1 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mOrderAddress Create (0.4ms)[0m   [0mINSERT INTO `order_addresses` (`address`, `city`, `zip`, `country_id`, `last_name`, `telephone`, `order_user_id`, `first_name`, `state`) VALUES('Zi-AP', 'Pune', '411048', 822512167, 'Kumar', '+919890654102', 1, 'Amit', 'Maharshtra')[0m
  [4;36;1mOrder Load (0.5ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (1.9ms)[0m   [0mUPDATE `orders` SET `shipping_address_id` = 3, `billing_address_id` = 3 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;35;1mSQL (117.7ms)[0m   [0mROLLBACK[0m


Something went bad when trying to checkout...
Validation failed: {{errors}}

/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/validations.rb:1102:in `save_without_dirty!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/dirty.rb:87:in `save_without_transactions!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:108:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:98:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:91:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:441:in `do_checkout'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/flash.rb:151:in `perform_action'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:438:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/head.rb:9:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/methodoverride.rb:24:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:128:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (1.3ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:16:06) [POST]
  Parameters: {"selected"=>822512167, "select_name"=>"billing_address", "id"=>nil}
Redirected to http://localhost:3000/public/error_page
Start rendering component ({:action=>"error_page", :controller=>"public"}): 

ActionView::TemplateError (uninitialized constant PublicController) on line #55 of vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:
52: 		<%= make_label('Country') %>
53: 		<%= render_component(:controller => "countries",
54: 		                      :action => show_obsolete ? "complete_select_list" : "select_list",
55: 		                      :params => {:select_name => "#{address_type}_address", :selected => selected_country}) %>
56: 	</div>
57: 	<div class="clear">&nbsp;</div>
58: 

    vendor/plugins/substruct/app/views/admin/orders/_address.rhtml:55:in `_run_rhtml_vendor47plugins47substruct47app47views47admin47orders47_address46rhtml_locals_address_address_type_object'
    vendor/plugins/substruct/app/views/store/checkout.rhtml:61:in `_run_rhtml_vendor47plugins47substruct47app47views47store47checkout46rhtml'
    vendor/plugins/substruct/app/controllers/store_controller.rb:486:in `do_checkout'
    vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'

Rendered rescues/_trace (257.9ms)
Rendered rescues/_request_and_response (1.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:16:43) [POST]
  Parameters: {"commit"=>"Submit Order Information", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "shipping_address"=>{"city"=>"", "address"=>"", "zip"=>"", "country_id"=>"880262049", "last_name"=>"", "telephone"=>"", "state"=>"", "first_name"=>""}, "billing_address"=>{"city"=>"Pune", "address"=>"Zi-AP", "zip"=>"411048", "country_id"=>"822512167", "last_name"=>"Kumar", "telephone"=>"+919890654102", "state"=>"Maharshtra", "first_name"=>"Amit"}, "order_user"=>{"email_address"=>"amitbaraik@gmail.com"}, "order_account"=>{"expiration_year"=>"2011", "expiration_month"=>"1", "cc_number"=>"4444444444444444"}, "use_separate_shipping_address"=>"true"}
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (3.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (2.7ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (3.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mPreference Load (2.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m



CREATING NEW ORDER FROM POST


true



  [4;35;1mOrderUser Load (0.8ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`email_address` = 'amitbaraik@gmail.com') LIMIT 1[0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mOrder Load (0.5ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrderLineItem Load (0.5ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.7ms)[0m   [0mUPDATE `orders` SET `product_cost` = 450.0, `order_user_id` = 1 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.4ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mOrderAddress Create (0.4ms)[0m   [0mINSERT INTO `order_addresses` (`address`, `city`, `zip`, `country_id`, `last_name`, `telephone`, `order_user_id`, `first_name`, `state`) VALUES('Zi-AP', 'Pune', '411048', 822512167, 'Kumar', '+919890654102', 1, 'Amit', 'Maharshtra')[0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.7ms)[0m   [0mUPDATE `orders` SET `shipping_address_id` = 4, `billing_address_id` = 4 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.6ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 880262049) [0m
  [4;35;1mSQL (122.6ms)[0m   [0mROLLBACK[0m


Something went bad when trying to checkout...
Validation failed: {{errors}}

/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/validations.rb:1102:in `save_without_dirty!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/dirty.rb:87:in `save_without_transactions!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:208:in `rollback_active_record_state!'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:200:in `save!'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:108:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:98:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:136:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/transactions.rb:182:in `transaction'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/order_helper.rb:91:in `create_order_from_post'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:441:in `do_checkout'
/home/amit/substruct_rel_1-3-1/vendor/plugins/substruct/app/controllers/store_controller.rb:242:in `checkout'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:1331:in `perform_action_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/home/amit/substruct_rel_1-3-1/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/flash.rb:151:in `perform_action'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `send'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:532:in `process_without_filters'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:438:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:87:in `dispatch'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:121:in `_call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:130
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/string_coercion.rb:25:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/head.rb:9:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/methodoverride.rb:24:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:128:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/failsafe.rb:26:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `synchronize'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/lock.rb:11:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:114:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/reloader.rb:34:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:108:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:47:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `each'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/urlmap.rb:41:in `call'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/content_length.rb:13:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/chunked.rb:15:in `call'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:67:in `process'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/var/lib/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/var/lib/gems/1.8/gems/rack-1.1.0/lib/rack/handler/mongrel.rb:38:in `run'
/home/amit/substruct_rel_1-3-1/vendor/rails/railties/lib/commands/server.rb:111
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (1.7ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:16:44) [POST]
  Parameters: {"selected"=>822512167, "select_name"=>"billing_address", "id"=>nil}
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.5ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mCountry Load (2.8ms)[0m   [0mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 27ms (View: 6, DB: 4) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (42.7ms)
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>880262049, :select_name=>"shipping_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:16:44) [POST]
  Parameters: {"selected"=>880262049, "select_name"=>"shipping_address", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 15ms (View: 5, DB: 0) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (42.6ms)
Rendered admin/orders/_account (4.2ms)
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (NOW() BETWEEN start AND end) LIMIT 1[0m
  [4;35;1mItem Load (1.1ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (51.8ms)
Rendered store/_clear_cart (0.2ms)
Rendered shared/_flash (0.7ms)
Completed in 661ms (View: 174, DB: 156) | 200 OK [http://localhost/store/checkout]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:17:28) [POST]
  Parameters: {"commit"=>"Submit Order Information", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM=", "shipping_address"=>{"city"=>"", "address"=>"", "zip"=>"", "country_id"=>"880262049", "last_name"=>"", "telephone"=>"", "state"=>"", "first_name"=>""}, "billing_address"=>{"city"=>"Pune", "address"=>"Zi-AP", "zip"=>"411048", "country_id"=>"822512167", "last_name"=>"Kumar", "telephone"=>"+919890654102", "state"=>"Maharshtra", "first_name"=>"Amit"}, "order_user"=>{"email_address"=>"amitbaraik@gmail.com"}, "order_account"=>{"expiration_year"=>"2013", "expiration_month"=>"5", "cc_number"=>"4987654321098769"}}
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.9ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.6ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.8ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.4ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m



CREATING NEW ORDER FROM POST






  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`email_address` = 'amitbaraik@gmail.com') LIMIT 1[0m
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;36;1mOrder Load (0.5ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_require_login') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrderLineItem Load (0.5ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.6ms)[0m   [0mUPDATE `orders` SET `product_cost` = 450.0, `order_user_id` = 1 WHERE `id` = 1[0m
  [4;36;1mCountry Load (0.7ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mOrderAddress Create (0.4ms)[0m   [0mINSERT INTO `order_addresses` (`address`, `city`, `zip`, `country_id`, `last_name`, `telephone`, `order_user_id`, `first_name`, `state`) VALUES('Zi-AP', 'Pune', '411048', 822512167, 'Kumar', '+919890654102', 1, 'Amit', 'Maharshtra')[0m
  [4;36;1mOrder Load (0.8ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.4ms)[0m   [0mUPDATE `orders` SET `shipping_address_id` = 5, `billing_address_id` = 5 WHERE `id` = 1[0m
  [4;36;1mOrderAccount Create (0.4ms)[0m   [0;1mINSERT INTO `order_accounts` (`expiration_year`, `routing_number`, `bank_name`, `account_number`, `expiration_month`, `order_account_type_id`, `credit_ccv`, `order_user_id`, `cc_number`) VALUES(2013, NULL, NULL, NULL, 5, 1, NULL, 1, 'shWrXpko6eJVDdH7PbkAtaLpSUeGT8yoC0PqErra5S0=\n')[0m
  [4;35;1mPromotion Load (0.9ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (0.4ms)[0m   [0mUPDATE `orders` SET `order_account_id` = 1 WHERE `id` = 1[0m
  [4;36;1mSQL (61.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mPreference Load (1.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;36;1mItem Load (1.1ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
REMOVED ITEMS: []
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m


TRYING TO REDIRECT...
Redirected to http://localhost:3000/store/select_shipping_method
Completed in 281ms (DB: 78) | 302 Found [http://localhost/store/checkout]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#select_shipping_method (for 127.0.0.1 at 2011-02-09 12:17:28) [GET]
  [4;36;1mPreference Load (0.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.5ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mOrderAddress Load (0.4ms)[0m   [0mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_home_country') LIMIT 1[0m
  [4;35;1mOrderShippingType Load (1.6ms)[0m   [0mSELECT * FROM `order_shipping_types` WHERE (is_domestic = 0) ORDER BY price ASC[0m
  [4;36;1mOrderLineItem Load (0.4ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mItem Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_shipping_weights` WHERE (`order_shipping_weights`.order_shipping_type_id = 4) [0m
  [4;35;1mPreference Load (4.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_handling_fee') LIMIT 1[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_shipping_weights` WHERE (`order_shipping_weights`.order_shipping_type_id = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_handling_fee') LIMIT 1[0m
Rendering template within layouts/checkout
Rendering store/select_shipping_method
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (19.7ms)
Rendered store/_clear_cart (0.2ms)
Rendered shared/_flash (0.2ms)
Completed in 298ms (View: 99, DB: 14) | 200 OK [http://localhost/store/select_shipping_method]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#set_shipping_method (for 127.0.0.1 at 2011-02-09 12:17:40) [POST]
  Parameters: {"ship_type_id"=>"4", "commit"=>"Select Shipping Method", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM="}
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (1.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.8ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mOrder Load (0.5ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrderLineItem Load (0.3ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrder Update (0.5ms)[0m   [0;1mUPDATE `orders` SET `shipping_cost` = 75.0, `order_shipping_type_id` = 4 WHERE `id` = 1[0m
  [4;35;1mSQL (92.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_show_confirmation') LIMIT 1[0m
Redirected to http://localhost:3000/store/confirm_order
Completed in 170ms (DB: 102) | 302 Found [http://localhost/store/set_shipping_method]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#confirm_order (for 127.0.0.1 at 2011-02-09 12:17:41) [GET]
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.4ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.6ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.5ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mPreference Load (0.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_login') LIMIT 1[0m
Rendering template within layouts/checkout
Rendering store/confirm_order
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mOrderLineItem Load (0.5ms)[0m   [0mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mItem Load (0.5ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrderShippingType Load (0.4ms)[0m   [0;1mSELECT * FROM `order_shipping_types` WHERE (`order_shipping_types`.`id` = 4) [0m
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 75.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (188.6ms)
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
Rendered shared/_flash (0.2ms)
Completed in 308ms (View: 225, DB: 8) | 200 OK [http://localhost/store/confirm_order]
  [4;35;1mPreference Load (0.8ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#finish_order (for 127.0.0.1 at 2011-02-09 12:17:44) [POST]
  Parameters: {"commit"=>"Finish your order", "authenticity_token"=>"AM6FFHJxum299c5XEWI7jt/+hPzsPSOHlGUfzc3WqVM="}
  [4;36;1mPreference Load (2.4ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mTag Load (0.6ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mOrderUser Load (0.6ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mOrder Load (0.4ms)[0m   [0mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;36;1mPromotion Load (0.5ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;35;1mPromotion Load (0.3ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mPreference Load (0.6ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mOrderAddress Load (0.4ms)[0m   [0mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
  [4;36;1mOrderAccount Load (0.4ms)[0m   [0;1mSELECT * FROM `order_accounts` WHERE (`order_accounts`.`id` = 1) [0m
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_login') LIMIT 1[0m
  [4;36;1mPreference Load (0.6ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_pass') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m
  [4;36;1mCountry Load (0.5ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
CALCULATING SHIPPING TOTAL
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mOrderLineItem Load (0.5ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 75.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m


[ERROR] FAILED ORDER 
#<ActiveMerchant::Billing::Response:0xb6f43920 @cvv_result={"code"=>nil, "message"=>nil}, @test=1, @avs_result={"code"=>"P", "postal_match"=>"Y", "street_match"=>"N", "message"=>"Postal code matches, but street address not verified."}, @message="(TESTMODE) The merchant login ID or password is invalid or the account is inactive", @success=false, @authorization="0", @params={"response_reason_text"=>"(TESTMODE) The merchant login ID or password is invalid or the account is inactive.", "response_code"=>3, "transaction_id"=>"0", "response_reason_code"=>"13", "avs_result_code"=>"P", "card_code"=>""}, @fraud_review=false>
(TESTMODE) The merchant login ID or password is invalid or the account is inactive


  [4;36;1mOrderStatusCode Load (0.7ms)[0m   [0;1mSELECT * FROM `order_status_codes` WHERE (`order_status_codes`.`name` = 'ON HOLD - PAYMENT FAILED') LIMIT 1[0m
  [4;35;1mSQL (4.6ms)[0m   [0mBEGIN[0m
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT `orders`.id FROM `orders` WHERE (`orders`.`order_number` = 561335069 AND `orders`.id <> 1) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrder Update (5.6ms)[0m   [0mUPDATE `orders` SET `notes` = '<p>Order failed!<br/>(TESTMODE) The merchant login ID or password is invalid or the account is inactive<br/><span class=\"info\">[02-09-11 12:17 PM]</span></p>', `order_status_code_id` = 3, `auth_transaction_id` = '0' WHERE `id` = 1[0m
  [4;36;1mSQL (90.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mPreference Load (9.5ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_copy_to') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_username') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_copy_to') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_username') LIMIT 1[0m
  [4;35;1mOrderAddress Load (0.8ms)[0m   [0mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
  [4;36;1mCountry Load (3.6ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
  [4;35;1mOrderUser Load (0.5ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) [0m
  [4;36;1mItem Load (3.1ms)[0m   [0;1mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;35;1mOrderShippingType Load (1.6ms)[0m   [0mSELECT * FROM `order_shipping_types` WHERE (`order_shipping_types`.`id` = 4) [0m
CALCULATING SHIPPING TOTAL
  [4;36;1mPromotion Load (7.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 75.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered orders_mailer/_order (135.4ms)
Sent mail to 

Date: Wed, 9 Feb 2011 12:17:48 +0530
Subject: An order has failed on the site
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

This order has failed...

Order #: 561335069

ORDER DETAILS
============================================================
BILLING ADDRESS
--------------------
First Name: Amit
Last Name: Kumar
Address: Zi-AP
City: Pune
State: Maharshtra
Zip: 411048
Country: India

SHIPPING ADDRESS
--------------------
First Name: Amit
Last Name: Kumar
Address: Zi-AP
City: Pune
State: Maharshtra
Zip: 411048
Country: India
------------------------------------------------------------
Email: amitbaraik@gmail.com

CC Number: XXXXXXXXXXXX8769
CC Exp Month: 5
CC Exp Year: 2013

------------------------------------------------------------

Item Description: Amit
Quantity: 1
Amount Per Item: $450.00
Sub Total: $450.00

------------------------------------------------------------

Shipping Via: FedEx International Economy (International Only)

Ship/Handling: $75.00
============================================================
TOTAL: $525.00
Redirected to http://localhost:3000/store/checkout
Completed in 3697ms (DB: 140) | 302 Found [http://localhost/store/finish_order]
  [4;36;1mPreference Load (0.8ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#checkout (for 127.0.0.1 at 2011-02-09 12:17:48) [GET]
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.7ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'cc_processor') LIMIT 1[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) [0m
  [4;36;1mOrderAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
  [4;35;1mOrderAccount Load (0.4ms)[0m   [0mSELECT * FROM `order_accounts` WHERE (`order_accounts`.`id` = 1) [0m


EXISTING ORDER INIT

Order user is @customer
  [4;36;1mOrder Load (0.6ms)[0m   [0;1mSELECT * FROM `orders` WHERE (`orders`.order_user_id = 1) ORDER BY created_on DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_addresses` WHERE (`order_addresses`.`id` = 5) [0m
Rendering template within layouts/checkout
Rendering store/checkout
Rendered admin/orders/_user (3.4ms)
  [4;35;1mCountry Load (0.4ms)[0m   [0mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"billing_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:17:48) [GET]
  Parameters: {"selected"=>822512167, "select_name"=>"billing_address", "id"=>nil}
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;35;1mCountry Load (2.4ms)[0m   [0mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 23ms (View: 6, DB: 3) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (54.7ms)
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `countries` WHERE (`countries`.`id` = 822512167) [0m
Start rendering component ({:action=>"select_list", :controller=>"countries", :params=>{:selected=>822512167, :select_name=>"shipping_address"}}): 


Processing CountriesController#select_list (for 127.0.0.1 at 2011-02-09 12:17:48) [GET]
  Parameters: {"selected"=>822512167, "select_name"=>"shipping_address", "id"=>nil}
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `countries` WHERE (is_obsolete != 1) ORDER BY rank, name ASC[0m
Rendering countries/select_list
Completed in 12ms (View: 4, DB: 0) | 200 OK [http://localhost/store/checkout]


End of component rendering
Rendered admin/orders/_address (20.7ms)
Rendered admin/orders/_account (7.8ms)
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (NOW() BETWEEN start AND end) LIMIT 1[0m
  [4;36;1mOrderLineItem Load (0.4ms)[0m   [0;1mSELECT * FROM `order_line_items` WHERE (`order_line_items`.order_id = 1) [0m
  [4;35;1mItem Load (0.7ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`id` = 1) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mOrderShippingType Load (0.4ms)[0m   [0mSELECT * FROM `order_shipping_types` WHERE (`order_shipping_types`.`id` = 4) [0m
CALCULATING SHIPPING TOTAL
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
LINE ITEMS TOTAL: 450.0
SHIPPING COST: 75.0
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
TAX COST: 0.0
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
Rendered store/_cart_contents (60.6ms)
Rendered store/_clear_cart (0.2ms)
Rendered shared/_flash (0.9ms)
Completed in 359ms (View: 279, DB: 10) | 200 OK [http://localhost/store/checkout]
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#index (for 127.0.0.1 at 2011-02-09 12:18:09) [GET]
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.6ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.6ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.6ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.3ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mTag Load (0.4ms)[0m   [0mSELECT * FROM `tags` ORDER BY name ASC[0m
  [4;36;1mProduct Load (1.4ms)[0m   [0;1mSELECT * FROM `items` WHERE (
 CURRENT_DATE() >= DATE(items.date_available)
 AND items.is_discontinued = 0
 OR (items.is_discontinued = 1 AND (items.quantity > 0 OR items.variation_quantity > 0))
 ) AND ( (`items`.`type` = 'Product' ) ) ORDER BY name ASC LIMIT 0, 10[0m
Rendering template within layouts/main
Rendering store/index
  [4;35;1mTag Load (0.7ms)[0m   [0mSELECT `tags`.* FROM `tags` INNER JOIN `products_tags` ON `tags`.id = `products_tags`.tag_id WHERE (`tags`.`name` = 'On Sale') AND (`products_tags`.product_id = 1 ) LIMIT 1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSELECT count(*) AS count_all FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) [0m
  [4;35;1mImage Load (0.6ms)[0m   [0mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
Rendered store/_product (145.6ms)
Rendered shared/_flash (0.1ms)
Completed in 389ms (View: 161, DB: 9) | 200 OK [http://localhost/store]
  [4;36;1mPreference Load (1.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_test_transactions') LIMIT 1[0m


Processing StoreController#show (for 127.0.0.1 at 2011-02-09 12:18:14) [GET]
  Parameters: {"id"=>"A001"}
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_name') LIMIT 1[0m
  [4;36;1mTag Load (0.9ms)[0m   [0;1mSELECT * FROM `tags` WHERE (parent_id IS NULL OR parent_id = 0) ORDER BY -rank DESC[0m
  [4;35;1mOrderUser Load (0.4ms)[0m   [0mSELECT * FROM `order_users` WHERE (`order_users`.`id` = 1) LIMIT 1[0m
  [4;36;1mOrder Load (0.4ms)[0m   [0;1mSELECT * FROM `orders` WHERE (id = 1) LIMIT 1[0m
  [4;35;1mPromotion Load (0.8ms)[0m   [0mSELECT * FROM `promotions` WHERE (code = NULL) LIMIT 1[0m
  [4;36;1mPromotion Load (0.4ms)[0m   [0;1mSELECT * FROM `promotions` WHERE (`promotions`.`id` = 0) [0m
  [4;35;1mProduct Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.`code` = 'A001') AND ( (`items`.`type` = 'Product' ) ) LIMIT 1[0m
  [4;36;1mImage Load (0.8ms)[0m   [0;1mSELECT `user_uploads`.* FROM `user_uploads` INNER JOIN `product_images` ON `user_uploads`.id = `product_images`.image_id WHERE ((`product_images`.product_id = 1)) AND ( (`user_uploads`.`type` = 'Image' ) ) ORDER BY -product_images.rank DESC[0m
  [4;35;1mVariation Load (0.6ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.product_id = 1 AND (quantity > 0)) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendering template within layouts/main
Rendering store/show
  [4;36;1mProduct Load (0.7ms)[0m   [0;1mSELECT * FROM `items` INNER JOIN `related_products` ON `items`.id = `related_products`.related_id WHERE (`related_products`.product_id = 1 ) AND ( (`items`.`type` = 'Product' ) ) [0m
  [4;35;1mVariation Load (0.5ms)[0m   [0mSELECT * FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) ORDER BY price ASC[0m
  [4;36;1mPreference Load (0.5ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'store_use_inventory_control') LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `items` WHERE (`items`.product_id = 1) AND ( (`items`.`type` = 'Variation' ) ) [0m
Rendered shared/_flash (0.2ms)
Completed in 258ms (View: 41, DB: 10) | 200 OK [http://localhost/store/show/A001]
  [4;36;1mPreference Load (79.2ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (0.7ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.9ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (22.9ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (0.3ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
  [4;36;1mPreference Load (1.0ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'use_smtp_tls_patch') LIMIT 1[0m
  [4;35;1mPreference Load (0.7ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_host') LIMIT 1[0m
  [4;36;1mPreference Load (0.3ms)[0m   [0;1mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_port') LIMIT 1[0m
  [4;35;1mPreference Load (3.2ms)[0m   [0mSELECT * FROM `preferences` WHERE (`preferences`.`name` = 'mail_auth_type') LIMIT 1[0m
